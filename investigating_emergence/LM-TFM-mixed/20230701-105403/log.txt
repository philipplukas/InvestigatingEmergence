Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : mixed
    - n_layer : 12
    - n_head : 8
    - d_head : 16
    - d_embed : 128
    - d_model : 128
    - d_inner : 512
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 128
    - batch_chunk : 1
    - tgt_len : 128
    - eval_tgt_len : 128
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : True
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 100
    - work_dir : LM-TFM-mixed/20230701-105403
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 2
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - use_mask_training : False
    - tied : True
    - n_token : 257
    - n_all_param : 2406529
    - n_nonemb_param : 2373120
====================================================================================================
#params = 2406529
#non emb params = 2373120
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step      100 | time: 30.88s | valid loss 18.29 | valid ppl 87962347.760
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 273.71 | loss 153.33 | ppl 3908864827174650806274158214513136072489982578919346617951312674816.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      200 | time: 26.67s | valid loss 17.19 | valid ppl 29071924.428
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      300 | time: 26.96s | valid loss 16.98 | valid ppl 23607587.982
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 271.19 | loss 126.12 | ppl 5904304933592556876065512298337892610383267722092871680.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      400 | time: 26.90s | valid loss 15.12 | valid ppl 3698625.608
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      500 | time: 26.92s | valid loss 14.92 | valid ppl 3019710.144
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 271.46 | loss 110.34 | ppl 829852953511538752852962799518540271075813490688.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      600 | time: 27.06s | valid loss 13.55 | valid ppl 765084.924
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      700 | time: 26.98s | valid loss 13.00 | valid ppl 440353.461
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 272.01 | loss 96.89 | ppl 1204586883833769513510810819590132445741056.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      800 | time: 27.09s | valid loss 11.59 | valid ppl 107854.658
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      900 | time: 27.12s | valid loss 10.24 | valid ppl 28130.248
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 272.95 | loss 85.67 | ppl 16070816888429445963649709503070339072.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step     1000 | time: 27.18s | valid loss  8.77 | valid ppl  6431.528
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step     1100 | time: 25.33s | valid loss  8.50 | valid ppl  4929.410
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 244.09 | loss 76.12 | ppl 1149616153086664020508745089941504.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step     1200 | time: 23.14s | valid loss  7.53 | valid ppl  1860.183
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step     1300 | time: 23.14s | valid loss  7.52 | valid ppl  1849.541
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 233.45 | loss 69.17 | ppl 1094909317636658299169507639296.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step     1400 | time: 23.17s | valid loss  6.56 | valid ppl   706.084
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step     1500 | time: 23.25s | valid loss  6.31 | valid ppl   549.655
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 233.77 | loss 63.45 | ppl 3583496234357449620811939840.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step     1600 | time: 23.13s | valid loss  5.60 | valid ppl   271.650
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step     1700 | time: 23.17s | valid loss  5.76 | valid ppl   318.593
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 232.68 | loss 58.57 | ppl 27440593050951740939042816.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step     1800 | time: 23.23s | valid loss  5.22 | valid ppl   184.470
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step     1900 | time: 23.25s | valid loss  4.81 | valid ppl   122.907
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 234.08 | loss 54.74 | ppl 590502324352746703028224.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     2000 | time: 23.19s | valid loss  4.73 | valid ppl   113.838
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     2100 | time: 23.12s | valid loss  4.38 | valid ppl    79.695
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 233.32 | loss 51.95 | ppl 36315266598623523110912.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     2200 | time: 22.92s | valid loss  4.34 | valid ppl    76.502
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     2300 | time: 22.97s | valid loss  4.23 | valid ppl    68.719
----------------------------------------------------------------------------------------------------
| epoch   1 step     2400 |   2400 batches | lr 0.0001 | ms/batch 231.14 | loss 49.27 | ppl 2510692541863554973696.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     2400 | time: 22.87s | valid loss  4.09 | valid ppl    59.699
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     2500 | time: 22.99s | valid loss  3.80 | valid ppl    44.895
----------------------------------------------------------------------------------------------------
| epoch   1 step     2600 |   2600 batches | lr 0.0001 | ms/batch 232.00 | loss 47.11 | ppl 288431881600684556288.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     2600 | time: 23.12s | valid loss  3.86 | valid ppl    47.233
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     2700 | time: 23.02s | valid loss  3.72 | valid ppl    41.395
----------------------------------------------------------------------------------------------------
| epoch   1 step     2800 |   2800 batches | lr 0.0001 | ms/batch 231.13 | loss 45.01 | ppl 35372656468412198912.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     2800 | time: 23.18s | valid loss  3.55 | valid ppl    34.899
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     2900 | time: 23.18s | valid loss  3.33 | valid ppl    27.836
----------------------------------------------------------------------------------------------------
| epoch   1 step     3000 |   3000 batches | lr 0.0001 | ms/batch 233.58 | loss 42.85 | ppl 4049196438676674560.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     3000 | time: 23.19s | valid loss  3.08 | valid ppl    21.816
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     3100 | time: 23.09s | valid loss  2.97 | valid ppl    19.406
----------------------------------------------------------------------------------------------------
| epoch   1 step     3200 |   3200 batches | lr 0.0001 | ms/batch 232.43 | loss 41.15 | ppl 747090390807344640.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     3200 | time: 22.90s | valid loss  3.13 | valid ppl    22.844
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     3300 | time: 22.93s | valid loss  3.01 | valid ppl    20.272
----------------------------------------------------------------------------------------------------
| epoch   1 step     3400 |   3400 batches | lr 0.0001 | ms/batch 230.02 | loss 39.83 | ppl 199294842693038976.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     3400 | time: 23.05s | valid loss  2.77 | valid ppl    15.989
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     3500 | time: 22.95s | valid loss  2.73 | valid ppl    15.404
----------------------------------------------------------------------------------------------------
| epoch   1 step     3600 |   3600 batches | lr 0.0001 | ms/batch 231.74 | loss 38.64 | ppl 60284260376733880.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     3600 | time: 23.02s | valid loss  2.62 | valid ppl    13.693
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     3700 | time: 23.03s | valid loss  2.53 | valid ppl    12.577
----------------------------------------------------------------------------------------------------
| epoch   1 step     3800 |   3800 batches | lr 0.0001 | ms/batch 231.98 | loss 37.31 | ppl 16019066082881262.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     3800 | time: 23.02s | valid loss  2.58 | valid ppl    13.253
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     3900 | time: 23.06s | valid loss  2.41 | valid ppl    11.141
----------------------------------------------------------------------------------------------------
| epoch   1 step     4000 |   4000 batches | lr 0.0001 | ms/batch 231.62 | loss 36.11 | ppl 4805152413280044.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     4000 | time: 23.08s | valid loss  2.35 | valid ppl    10.470
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     4100 | time: 23.03s | valid loss  2.32 | valid ppl    10.171
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 0.0001 | ms/batch 232.00 | loss 34.90 | ppl 1434871433061777.500
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     4200 | time: 23.09s | valid loss  2.30 | valid ppl     9.955
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     4300 | time: 22.96s | valid loss  2.16 | valid ppl     8.654
----------------------------------------------------------------------------------------------------
| epoch   1 step     4400 |   4400 batches | lr 0.0001 | ms/batch 231.73 | loss 33.82 | ppl 488271350861864.812
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     4400 | time: 23.03s | valid loss  2.12 | valid ppl     8.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     4500 | time: 23.17s | valid loss  1.97 | valid ppl     7.188
----------------------------------------------------------------------------------------------------
| epoch   1 step     4600 |   4600 batches | lr 0.0001 | ms/batch 233.15 | loss 32.67 | ppl 154101977784766.312
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     4600 | time: 23.11s | valid loss  2.04 | valid ppl     7.659
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  47 at step     4700 | time: 23.18s | valid loss  1.96 | valid ppl     7.072
----------------------------------------------------------------------------------------------------
| epoch   1 step     4800 |   4800 batches | lr 0.0001 | ms/batch 232.51 | loss 31.67 | ppl 56612907855411.969
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  48 at step     4800 | time: 23.10s | valid loss  2.01 | valid ppl     7.492
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  49 at step     4900 | time: 23.17s | valid loss  1.96 | valid ppl     7.079
----------------------------------------------------------------------------------------------------
| epoch   1 step     5000 |   5000 batches | lr 0.0001 | ms/batch 231.55 | loss 30.73 | ppl 22276028708782.613
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  50 at step     5000 | time: 23.13s | valid loss  1.72 | valid ppl     5.585
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  51 at step     5100 | time: 23.17s | valid loss  1.84 | valid ppl     6.313
----------------------------------------------------------------------------------------------------
| epoch   1 step     5200 |   5200 batches | lr 0.0001 | ms/batch 232.63 | loss 29.76 | ppl 8442037411284.774
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  52 at step     5200 | time: 23.17s | valid loss  1.68 | valid ppl     5.348
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  53 at step     5300 | time: 22.97s | valid loss  1.80 | valid ppl     6.051
----------------------------------------------------------------------------------------------------
| epoch   1 step     5400 |   5400 batches | lr 0.0001 | ms/batch 231.43 | loss 28.82 | ppl 3269668141753.359
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  54 at step     5400 | time: 23.14s | valid loss  1.70 | valid ppl     5.454
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  55 at step     5500 | time: 23.13s | valid loss  1.62 | valid ppl     5.056
----------------------------------------------------------------------------------------------------
| epoch   1 step     5600 |   5600 batches | lr 0.0001 | ms/batch 232.09 | loss 28.03 | ppl 1486185571643.157
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  56 at step     5600 | time: 23.09s | valid loss  1.56 | valid ppl     4.750
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  57 at step     5700 | time: 22.94s | valid loss  1.54 | valid ppl     4.655
----------------------------------------------------------------------------------------------------
| epoch   1 step     5800 |   5800 batches | lr 0.0001 | ms/batch 231.30 | loss 27.18 | ppl 636118008451.251
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  58 at step     5800 | time: 22.87s | valid loss  1.56 | valid ppl     4.766
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  59 at step     5900 | time: 22.94s | valid loss  1.51 | valid ppl     4.521
----------------------------------------------------------------------------------------------------
| epoch   1 step     6000 |   6000 batches | lr 0.0001 | ms/batch 229.94 | loss 26.32 | ppl 268255644635.957
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  60 at step     6000 | time: 22.88s | valid loss  1.43 | valid ppl     4.177
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  61 at step     6100 | time: 22.90s | valid loss  1.46 | valid ppl     4.316
----------------------------------------------------------------------------------------------------
| epoch   1 step     6200 |   6200 batches | lr 0.0001 | ms/batch 230.07 | loss 25.40 | ppl 107271494328.561
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  62 at step     6200 | time: 23.01s | valid loss  1.30 | valid ppl     3.687
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  63 at step     6300 | time: 22.92s | valid loss  1.35 | valid ppl     3.839
----------------------------------------------------------------------------------------------------
| epoch   1 step     6400 |   6400 batches | lr 0.0001 | ms/batch 230.07 | loss 24.58 | ppl 47415979637.515
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  64 at step     6400 | time: 22.95s | valid loss  1.30 | valid ppl     3.665
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  65 at step     6500 | time: 23.00s | valid loss  1.32 | valid ppl     3.742
----------------------------------------------------------------------------------------------------
| epoch   1 step     6600 |   6600 batches | lr 0.0001 | ms/batch 231.18 | loss 23.89 | ppl 23814560878.097
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  66 at step     6600 | time: 23.01s | valid loss  1.30 | valid ppl     3.651
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  67 at step     6700 | time: 22.92s | valid loss  1.30 | valid ppl     3.670
----------------------------------------------------------------------------------------------------
| epoch   1 step     6800 |   6800 batches | lr 0.0001 | ms/batch 230.84 | loss 23.12 | ppl 10957081815.819
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  68 at step     6800 | time: 22.96s | valid loss  1.23 | valid ppl     3.409
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  69 at step     6900 | time: 22.95s | valid loss  1.27 | valid ppl     3.560
----------------------------------------------------------------------------------------------------
| epoch   1 step     7000 |   7000 batches | lr 0.0001 | ms/batch 230.26 | loss 22.44 | ppl 5576126925.563
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  70 at step     7000 | time: 22.90s | valid loss  1.21 | valid ppl     3.342
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  71 at step     7100 | time: 22.94s | valid loss  1.20 | valid ppl     3.308
----------------------------------------------------------------------------------------------------
| epoch   1 step     7200 |   7200 batches | lr 0.0001 | ms/batch 231.05 | loss 21.72 | ppl 2720962249.474
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  72 at step     7200 | time: 22.95s | valid loss  1.17 | valid ppl     3.227
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  73 at step     7300 | time: 22.93s | valid loss  1.19 | valid ppl     3.282
----------------------------------------------------------------------------------------------------
| epoch   1 step     7400 |   7400 batches | lr 0.0001 | ms/batch 229.65 | loss 20.97 | ppl 1280921790.104
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  74 at step     7400 | time: 22.80s | valid loss  1.11 | valid ppl     3.037
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  75 at step     7500 | time: 22.97s | valid loss  1.07 | valid ppl     2.910
----------------------------------------------------------------------------------------------------
| epoch   1 step     7600 |   7600 batches | lr 0.0001 | ms/batch 231.08 | loss 20.31 | ppl 660430896.396
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  76 at step     7600 | time: 22.99s | valid loss  1.11 | valid ppl     3.047
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  77 at step     7700 | time: 22.99s | valid loss  1.04 | valid ppl     2.817
----------------------------------------------------------------------------------------------------
| epoch   1 step     7800 |   7800 batches | lr 0.0001 | ms/batch 230.92 | loss 19.58 | ppl 317787698.210
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  78 at step     7800 | time: 22.91s | valid loss  1.05 | valid ppl     2.870
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  79 at step     7900 | time: 23.13s | valid loss  0.95 | valid ppl     2.587
----------------------------------------------------------------------------------------------------
| epoch   1 step     8000 |   8000 batches | lr 0.0001 | ms/batch 231.82 | loss 18.89 | ppl 160169679.553
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  80 at step     8000 | time: 23.14s | valid loss  0.94 | valid ppl     2.555
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  81 at step     8100 | time: 23.11s | valid loss  0.97 | valid ppl     2.641
----------------------------------------------------------------------------------------------------
| epoch   1 step     8200 |   8200 batches | lr 0.0001 | ms/batch 232.04 | loss 18.22 | ppl 81877379.847
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  82 at step     8200 | time: 23.18s | valid loss  0.98 | valid ppl     2.659
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  83 at step     8300 | time: 23.10s | valid loss  0.95 | valid ppl     2.578
----------------------------------------------------------------------------------------------------
| epoch   1 step     8400 |   8400 batches | lr 0.0001 | ms/batch 230.99 | loss 17.59 | ppl 43436823.772
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  84 at step     8400 | time: 23.03s | valid loss  0.87 | valid ppl     2.395
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  85 at step     8500 | time: 22.96s | valid loss  0.85 | valid ppl     2.345
----------------------------------------------------------------------------------------------------
| epoch   1 step     8600 |   8600 batches | lr 0.0001 | ms/batch 232.08 | loss 16.85 | ppl 20823087.490
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  86 at step     8600 | time: 23.15s | valid loss  0.89 | valid ppl     2.431
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  87 at step     8700 | time: 23.26s | valid loss  0.85 | valid ppl     2.347
----------------------------------------------------------------------------------------------------
| epoch   1 step     8800 |   8800 batches | lr 0.0001 | ms/batch 232.37 | loss 16.16 | ppl 10393111.021
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  88 at step     8800 | time: 23.14s | valid loss  0.84 | valid ppl     2.327
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  89 at step     8900 | time: 23.15s | valid loss  0.82 | valid ppl     2.273
----------------------------------------------------------------------------------------------------
| epoch   1 step     9000 |   9000 batches | lr 0.0001 | ms/batch 232.68 | loss 15.54 | ppl 5597492.644
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  90 at step     9000 | time: 23.05s | valid loss  0.83 | valid ppl     2.291
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  91 at step     9100 | time: 23.01s | valid loss  0.79 | valid ppl     2.199
----------------------------------------------------------------------------------------------------
| epoch   1 step     9200 |   9200 batches | lr 0.0001 | ms/batch 230.82 | loss 14.89 | ppl 2915622.472
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  92 at step     9200 | time: 22.97s | valid loss  0.77 | valid ppl     2.158
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  93 at step     9300 | time: 22.80s | valid loss  0.78 | valid ppl     2.178
----------------------------------------------------------------------------------------------------
| epoch   1 step     9400 |   9400 batches | lr 0.0001 | ms/batch 230.29 | loss 14.15 | ppl 1398684.919
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  94 at step     9400 | time: 22.98s | valid loss  0.74 | valid ppl     2.098
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  95 at step     9500 | time: 23.02s | valid loss  0.75 | valid ppl     2.117
----------------------------------------------------------------------------------------------------
| epoch   1 step     9600 |   9600 batches | lr 0.0001 | ms/batch 230.37 | loss 13.53 | ppl 754033.037
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  96 at step     9600 | time: 23.04s | valid loss  0.67 | valid ppl     1.959
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  97 at step     9700 | time: 23.00s | valid loss  0.71 | valid ppl     2.027
----------------------------------------------------------------------------------------------------
| epoch   1 step     9800 |   9800 batches | lr 0.0001 | ms/batch 231.60 | loss 12.84 | ppl 375817.447
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  98 at step     9800 | time: 23.02s | valid loss  0.70 | valid ppl     2.023
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  99 at step     9900 | time: 23.15s | valid loss  0.67 | valid ppl     1.964
----------------------------------------------------------------------------------------------------
| epoch   1 step    10000 |  10000 batches | lr 0.0001 | ms/batch 230.96 | loss 12.18 | ppl 195207.933
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 100 at step    10000 | time: 23.09s | valid loss  0.68 | valid ppl     1.964
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 101 at step    10100 | time: 23.06s | valid loss  0.67 | valid ppl     1.954
----------------------------------------------------------------------------------------------------
| epoch   1 step    10200 |  10200 batches | lr 0.0001 | ms/batch 231.85 | loss 11.62 | ppl 111294.244
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 102 at step    10200 | time: 23.08s | valid loss  0.65 | valid ppl     1.917
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 103 at step    10300 | time: 22.98s | valid loss  0.64 | valid ppl     1.898
----------------------------------------------------------------------------------------------------
| epoch   1 step    10400 |  10400 batches | lr 0.0001 | ms/batch 232.00 | loss 10.99 | ppl 59150.329
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 104 at step    10400 | time: 23.14s | valid loss  0.64 | valid ppl     1.892
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 105 at step    10500 | time: 22.98s | valid loss  0.61 | valid ppl     1.842
----------------------------------------------------------------------------------------------------
| epoch   1 step    10600 |  10600 batches | lr 0.0001 | ms/batch 231.69 | loss 10.37 | ppl 32031.734
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 106 at step    10600 | time: 22.92s | valid loss  0.59 | valid ppl     1.812
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 107 at step    10700 | time: 23.02s | valid loss  0.59 | valid ppl     1.806
----------------------------------------------------------------------------------------------------
| epoch   1 step    10800 |  10800 batches | lr 0.0001 | ms/batch 232.27 | loss  9.74 | ppl 16928.205
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 108 at step    10800 | time: 23.10s | valid loss  0.58 | valid ppl     1.778
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 109 at step    10900 | time: 23.05s | valid loss  0.54 | valid ppl     1.720
----------------------------------------------------------------------------------------------------
| epoch   1 step    11000 |  11000 batches | lr 0.0001 | ms/batch 232.31 | loss  9.11 | ppl  9010.242
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 110 at step    11000 | time: 23.06s | valid loss  0.53 | valid ppl     1.700
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 111 at step    11100 | time: 23.06s | valid loss  0.55 | valid ppl     1.736
----------------------------------------------------------------------------------------------------
| epoch   1 step    11200 |  11200 batches | lr 0.0001 | ms/batch 232.08 | loss  8.48 | ppl  4815.192
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 112 at step    11200 | time: 23.32s | valid loss  0.53 | valid ppl     1.691
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 113 at step    11300 | time: 23.26s | valid loss  0.50 | valid ppl     1.641
----------------------------------------------------------------------------------------------------
| epoch   1 step    11400 |  11400 batches | lr 0.0001 | ms/batch 234.53 | loss  7.89 | ppl  2672.742
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 114 at step    11400 | time: 23.31s | valid loss  0.51 | valid ppl     1.666
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 115 at step    11500 | time: 23.24s | valid loss  0.48 | valid ppl     1.620
----------------------------------------------------------------------------------------------------
| epoch   1 step    11600 |  11600 batches | lr 0.0001 | ms/batch 233.76 | loss  7.32 | ppl  1509.512
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 116 at step    11600 | time: 23.38s | valid loss  0.47 | valid ppl     1.595
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 117 at step    11700 | time: 23.24s | valid loss  0.46 | valid ppl     1.579
----------------------------------------------------------------------------------------------------
| epoch   1 step    11800 |  11800 batches | lr 0.0001 | ms/batch 234.78 | loss  6.72 | ppl   830.818
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 118 at step    11800 | time: 23.37s | valid loss  0.44 | valid ppl     1.558
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 119 at step    11900 | time: 23.30s | valid loss  0.44 | valid ppl     1.549
----------------------------------------------------------------------------------------------------
| epoch   1 step    12000 |  12000 batches | lr 0.0001 | ms/batch 235.13 | loss  6.16 | ppl   474.549
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 120 at step    12000 | time: 23.30s | valid loss  0.43 | valid ppl     1.542
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 121 at step    12100 | time: 23.18s | valid loss  0.41 | valid ppl     1.503
----------------------------------------------------------------------------------------------------
| epoch   1 step    12200 |  12200 batches | lr 0.0001 | ms/batch 233.91 | loss  5.57 | ppl   263.493
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 122 at step    12200 | time: 23.03s | valid loss  0.39 | valid ppl     1.484
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 123 at step    12300 | time: 23.03s | valid loss  0.40 | valid ppl     1.490
----------------------------------------------------------------------------------------------------
| epoch   1 step    12400 |  12400 batches | lr 0.0001 | ms/batch 230.67 | loss  4.99 | ppl   147.508
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 124 at step    12400 | time: 22.97s | valid loss  0.40 | valid ppl     1.493
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 125 at step    12500 | time: 22.98s | valid loss  0.38 | valid ppl     1.460
----------------------------------------------------------------------------------------------------
| epoch   1 step    12600 |  12600 batches | lr 0.0001 | ms/batch 230.96 | loss  4.46 | ppl    86.840
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 126 at step    12600 | time: 23.06s | valid loss  0.37 | valid ppl     1.450
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 127 at step    12700 | time: 22.91s | valid loss  0.37 | valid ppl     1.449
----------------------------------------------------------------------------------------------------
| epoch   1 step    12800 |  12800 batches | lr 0.0001 | ms/batch 231.44 | loss  3.96 | ppl    52.503
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 128 at step    12800 | time: 22.97s | valid loss  0.36 | valid ppl     1.438
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 129 at step    12900 | time: 23.11s | valid loss  0.36 | valid ppl     1.433
----------------------------------------------------------------------------------------------------
| epoch   1 step    13000 |  13000 batches | lr 0.0001 | ms/batch 232.10 | loss  3.55 | ppl    34.737
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 130 at step    13000 | time: 23.09s | valid loss  0.36 | valid ppl     1.431
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 131 at step    13100 | time: 23.02s | valid loss  0.35 | valid ppl     1.423
----------------------------------------------------------------------------------------------------
| epoch   1 step    13200 |  13200 batches | lr 0.0001 | ms/batch 231.99 | loss  3.21 | ppl    24.795
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 132 at step    13200 | time: 22.98s | valid loss  0.36 | valid ppl     1.435
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 133 at step    13300 | time: 22.97s | valid loss  0.36 | valid ppl     1.433
----------------------------------------------------------------------------------------------------
| epoch   1 step    13400 |  13400 batches | lr 0.0001 | ms/batch 229.96 | loss  2.93 | ppl    18.673
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 134 at step    13400 | time: 23.10s | valid loss  0.36 | valid ppl     1.434
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 135 at step    13500 | time: 23.07s | valid loss  0.35 | valid ppl     1.423
----------------------------------------------------------------------------------------------------
| epoch   1 step    13600 |  13600 batches | lr 0.0001 | ms/batch 231.99 | loss  2.72 | ppl    15.232
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 136 at step    13600 | time: 22.99s | valid loss  0.36 | valid ppl     1.433
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 137 at step    13700 | time: 23.02s | valid loss  0.36 | valid ppl     1.431
----------------------------------------------------------------------------------------------------
| epoch   1 step    13800 |  13800 batches | lr 0.0001 | ms/batch 229.41 | loss  2.61 | ppl    13.542
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 138 at step    13800 | time: 22.89s | valid loss  0.36 | valid ppl     1.434
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 139 at step    13900 | time: 22.92s | valid loss  0.36 | valid ppl     1.432
----------------------------------------------------------------------------------------------------
| epoch   1 step    14000 |  14000 batches | lr 0.0001 | ms/batch 229.84 | loss  2.54 | ppl    12.705
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 140 at step    14000 | time: 22.96s | valid loss  0.35 | valid ppl     1.424
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 141 at step    14100 | time: 22.93s | valid loss  0.36 | valid ppl     1.434
----------------------------------------------------------------------------------------------------
| epoch   1 step    14200 |  14200 batches | lr 0.0001 | ms/batch 229.48 | loss  2.51 | ppl    12.261
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 142 at step    14200 | time: 23.11s | valid loss  0.36 | valid ppl     1.427
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 143 at step    14300 | time: 23.22s | valid loss  0.36 | valid ppl     1.429
----------------------------------------------------------------------------------------------------
| epoch   1 step    14400 |  14400 batches | lr 0.0001 | ms/batch 232.13 | loss  2.48 | ppl    12.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 144 at step    14400 | time: 23.19s | valid loss  0.35 | valid ppl     1.421
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 145 at step    14500 | time: 23.21s | valid loss  0.36 | valid ppl     1.427
----------------------------------------------------------------------------------------------------
| epoch   1 step    14600 |  14600 batches | lr 0.0001 | ms/batch 233.19 | loss  2.47 | ppl    11.822
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 146 at step    14600 | time: 23.15s | valid loss  0.35 | valid ppl     1.418
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 147 at step    14700 | time: 23.30s | valid loss  0.35 | valid ppl     1.421
----------------------------------------------------------------------------------------------------
| epoch   1 step    14800 |  14800 batches | lr 0.0001 | ms/batch 232.64 | loss  2.46 | ppl    11.699
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 148 at step    14800 | time: 23.05s | valid loss  0.35 | valid ppl     1.424
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 149 at step    14900 | time: 23.25s | valid loss  0.35 | valid ppl     1.421
----------------------------------------------------------------------------------------------------
| epoch   1 step    15000 |  15000 batches | lr 0.0001 | ms/batch 232.68 | loss  2.45 | ppl    11.588
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 150 at step    15000 | time: 23.28s | valid loss  0.35 | valid ppl     1.416
----------------------------------------------------------------------------------------------------
