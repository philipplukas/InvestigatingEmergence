Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : mixed
    - n_layer : 12
    - n_head : 8
    - d_head : 16
    - d_embed : 128
    - d_model : 128
    - d_inner : 512
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 128
    - batch_chunk : 1
    - tgt_len : 128
    - eval_tgt_len : 128
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : True
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 100
    - work_dir : LM-TFM-mixed/20230701-150035
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 2
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - use_mask_training : False
    - tied : True
    - n_token : 257
    - n_all_param : 2406529
    - n_nonemb_param : 2373120
====================================================================================================
#params = 2406529
#non emb params = 2373120
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step      100 | time: 25.49s | valid loss  0.28 | valid ppl     1.321
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 239.37 | loss  2.24 | ppl     9.357
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      200 | time: 24.87s | valid loss  0.26 | valid ppl     1.301
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      300 | time: 24.88s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 251.88 | loss  1.64 | ppl     5.144
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      400 | time: 24.97s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      500 | time: 24.99s | valid loss  0.26 | valid ppl     1.301
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 249.87 | loss  1.57 | ppl     4.811
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      600 | time: 25.06s | valid loss  0.26 | valid ppl     1.292
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      700 | time: 24.99s | valid loss  0.26 | valid ppl     1.301
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 251.49 | loss  1.55 | ppl     4.732
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      800 | time: 25.07s | valid loss  0.26 | valid ppl     1.297
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      900 | time: 25.06s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 250.86 | loss  1.55 | ppl     4.688
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step     1000 | time: 25.06s | valid loss  0.26 | valid ppl     1.296
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step     1100 | time: 23.12s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 221.17 | loss  1.54 | ppl     4.656
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step     1200 | time: 21.15s | valid loss  0.26 | valid ppl     1.299
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step     1300 | time: 21.11s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 211.55 | loss  1.53 | ppl     4.630
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step     1400 | time: 21.11s | valid loss  0.26 | valid ppl     1.297
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step     1500 | time: 21.06s | valid loss  0.26 | valid ppl     1.294
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 210.97 | loss  1.53 | ppl     4.611
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step     1600 | time: 21.10s | valid loss  0.26 | valid ppl     1.299
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step     1700 | time: 21.05s | valid loss  0.26 | valid ppl     1.297
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 210.66 | loss  1.52 | ppl     4.594
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step     1800 | time: 21.09s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step     1900 | time: 21.05s | valid loss  0.26 | valid ppl     1.299
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 210.82 | loss  1.52 | ppl     4.580
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     2000 | time: 21.08s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     2100 | time: 21.09s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 210.23 | loss  1.52 | ppl     4.568
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     2200 | time: 20.89s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     2300 | time: 20.99s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
| epoch   1 step     2400 |   2400 batches | lr 0.0001 | ms/batch 210.33 | loss  1.52 | ppl     4.559
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     2400 | time: 21.00s | valid loss  0.26 | valid ppl     1.301
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     2500 | time: 20.99s | valid loss  0.26 | valid ppl     1.299
----------------------------------------------------------------------------------------------------
| epoch   1 step     2600 |   2600 batches | lr 0.0001 | ms/batch 209.85 | loss  1.52 | ppl     4.551
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     2600 | time: 20.99s | valid loss  0.26 | valid ppl     1.296
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     2700 | time: 21.01s | valid loss  0.26 | valid ppl     1.295
----------------------------------------------------------------------------------------------------
| epoch   1 step     2800 |   2800 batches | lr 0.0001 | ms/batch 210.09 | loss  1.51 | ppl     4.544
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     2800 | time: 21.01s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     2900 | time: 21.01s | valid loss  0.26 | valid ppl     1.297
----------------------------------------------------------------------------------------------------
| epoch   1 step     3000 |   3000 batches | lr 0.0001 | ms/batch 210.32 | loss  1.51 | ppl     4.538
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     3000 | time: 21.03s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     3100 | time: 21.02s | valid loss  0.26 | valid ppl     1.291
----------------------------------------------------------------------------------------------------
| epoch   1 step     3200 |   3200 batches | lr 0.0001 | ms/batch 210.37 | loss  1.51 | ppl     4.532
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     3200 | time: 20.97s | valid loss  0.26 | valid ppl     1.299
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     3300 | time: 20.97s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
| epoch   1 step     3400 |   3400 batches | lr 0.0001 | ms/batch 210.38 | loss  1.51 | ppl     4.529
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     3400 | time: 20.98s | valid loss  0.26 | valid ppl     1.297
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     3500 | time: 20.97s | valid loss  0.26 | valid ppl     1.296
----------------------------------------------------------------------------------------------------
| epoch   1 step     3600 |   3600 batches | lr 0.0001 | ms/batch 209.87 | loss  1.51 | ppl     4.525
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     3600 | time: 20.96s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     3700 | time: 21.00s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
| epoch   1 step     3800 |   3800 batches | lr 0.0001 | ms/batch 209.90 | loss  1.51 | ppl     4.523
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     3800 | time: 21.07s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     3900 | time: 20.96s | valid loss  0.26 | valid ppl     1.294
----------------------------------------------------------------------------------------------------
| epoch   1 step     4000 |   4000 batches | lr 0.0001 | ms/batch 210.25 | loss  1.51 | ppl     4.520
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     4000 | time: 20.99s | valid loss  0.26 | valid ppl     1.292
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     4100 | time: 21.21s | valid loss  0.26 | valid ppl     1.299
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 0.0001 | ms/batch 211.36 | loss  1.51 | ppl     4.517
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     4200 | time: 21.14s | valid loss  0.26 | valid ppl     1.296
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     4300 | time: 21.03s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
| epoch   1 step     4400 |   4400 batches | lr 0.0001 | ms/batch 210.99 | loss  1.51 | ppl     4.515
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     4400 | time: 21.13s | valid loss  0.26 | valid ppl     1.295
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     4500 | time: 21.12s | valid loss  0.26 | valid ppl     1.295
----------------------------------------------------------------------------------------------------
| epoch   1 step     4600 |   4600 batches | lr 0.0001 | ms/batch 211.40 | loss  1.51 | ppl     4.514
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     4600 | time: 21.15s | valid loss  0.26 | valid ppl     1.296
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  47 at step     4700 | time: 21.14s | valid loss  0.26 | valid ppl     1.297
----------------------------------------------------------------------------------------------------
| epoch   1 step     4800 |   4800 batches | lr 0.0001 | ms/batch 211.36 | loss  1.51 | ppl     4.512
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  48 at step     4800 | time: 21.09s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  49 at step     4900 | time: 21.14s | valid loss  0.26 | valid ppl     1.300
----------------------------------------------------------------------------------------------------
| epoch   1 step     5000 |   5000 batches | lr 0.0001 | ms/batch 211.37 | loss  1.51 | ppl     4.510
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  50 at step     5000 | time: 21.12s | valid loss  0.26 | valid ppl     1.298
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  51 at step     5100 | time: 21.11s | valid loss  0.26 | valid ppl     1.294
----------------------------------------------------------------------------------------------------
