Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : mixed
    - n_layer : 6
    - n_head : 6
    - d_head : 256
    - d_embed : 256
    - d_model : 256
    - d_inner : 512
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 128
    - batch_chunk : 1
    - tgt_len : 127
    - eval_tgt_len : 127
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 50
    - work_dir : LM-TFM-mixed/20230514-121148
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 1
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - tied : True
    - n_token : 256
    - n_all_param : 12270812
    - n_nonemb_param : 11020800
====================================================================================================
#params = 12270812
#non emb params = 11020800
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step       50 | time: 17.13s | valid loss  5.73 | valid ppl   307.953
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      100 | time: 16.69s | valid loss  6.83 | valid ppl   924.339
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      150 | time: 16.75s | valid loss  8.06 | valid ppl  3149.887
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 326.90 | loss  0.66 | ppl     1.943
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      200 | time: 16.69s | valid loss  8.04 | valid ppl  3117.022
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      250 | time: 16.68s | valid loss  8.17 | valid ppl  3549.838
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      300 | time: 16.74s | valid loss  8.17 | valid ppl  3525.343
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      350 | time: 16.83s | valid loss  8.25 | valid ppl  3810.091
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 335.59 | loss  0.01 | ppl     1.015
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      400 | time: 16.92s | valid loss  8.49 | valid ppl  4872.140
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      450 | time: 16.93s | valid loss  8.69 | valid ppl  5962.823
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step      500 | time: 16.88s | valid loss  8.84 | valid ppl  6884.908
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step      550 | time: 16.85s | valid loss  8.98 | valid ppl  7965.862
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 337.77 | loss  0.00 | ppl     1.002
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step      600 | time: 16.88s | valid loss  9.11 | valid ppl  9028.175
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step      650 | time: 16.88s | valid loss  9.25 | valid ppl 10373.944
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step      700 | time: 16.86s | valid loss  9.37 | valid ppl 11735.191
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step      750 | time: 16.91s | valid loss  9.48 | valid ppl 13085.744
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 337.74 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step      800 | time: 16.86s | valid loss  9.57 | valid ppl 14283.958
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step      850 | time: 16.88s | valid loss  9.62 | valid ppl 15018.033
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step      900 | time: 16.96s | valid loss  9.77 | valid ppl 17567.301
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step      950 | time: 16.88s | valid loss  9.61 | valid ppl 14901.067
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 338.31 | loss  0.00 | ppl     1.002
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     1000 | time: 16.91s | valid loss 10.05 | valid ppl 23084.819
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     1050 | time: 16.87s | valid loss 10.22 | valid ppl 27460.854
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     1100 | time: 16.95s | valid loss 10.30 | valid ppl 29763.409
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     1150 | time: 16.88s | valid loss 10.37 | valid ppl 32028.080
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 338.07 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     1200 | time: 16.91s | valid loss 10.44 | valid ppl 34305.709
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     1250 | time: 16.88s | valid loss 10.51 | valid ppl 36682.660
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     1300 | time: 16.91s | valid loss 10.58 | valid ppl 39168.775
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     1350 | time: 16.91s | valid loss 10.64 | valid ppl 41734.929
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 338.18 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     1400 | time: 16.93s | valid loss 10.70 | valid ppl 44413.706
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     1450 | time: 16.87s | valid loss 10.76 | valid ppl 47173.970
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     1500 | time: 16.88s | valid loss 10.82 | valid ppl 49883.852
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     1550 | time: 16.90s | valid loss 10.87 | valid ppl 52820.965
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 337.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     1600 | time: 16.88s | valid loss 10.93 | valid ppl 55785.817
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     1650 | time: 16.95s | valid loss 10.98 | valid ppl 58814.724
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     1700 | time: 16.88s | valid loss 11.03 | valid ppl 61995.071
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     1750 | time: 16.92s | valid loss 11.09 | valid ppl 65305.415
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 338.35 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     1800 | time: 16.90s | valid loss 11.14 | valid ppl 68626.968
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     1850 | time: 16.88s | valid loss 11.19 | valid ppl 72181.437
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     1900 | time: 16.90s | valid loss 11.23 | valid ppl 75721.723
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     1950 | time: 16.89s | valid loss 11.28 | valid ppl 79320.418
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 337.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     2000 | time: 16.88s | valid loss 11.33 | valid ppl 83123.708
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     2050 | time: 16.89s | valid loss 11.37 | valid ppl 86896.791
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     2100 | time: 16.91s | valid loss 11.41 | valid ppl 90668.912
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     2150 | time: 17.01s | valid loss 11.46 | valid ppl 94779.420
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 338.58 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     2200 | time: 16.92s | valid loss 11.50 | valid ppl 98914.754
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     2250 | time: 16.96s | valid loss 11.54 | valid ppl 102954.925
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     2300 | time: 16.91s | valid loss 11.59 | valid ppl 107916.159
----------------------------------------------------------------------------------------------------
