Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : mixed
    - n_layer : 2
    - n_head : 6
    - d_head : 128
    - d_embed : 128
    - d_model : 128
    - d_inner : 64
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 128
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 50
    - work_dir : LM-TFM-mixed/20230514-135735
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 1
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - tied : True
    - n_token : 256
    - n_all_param : 904704
    - n_nonemb_param : 820608
====================================================================================================
#params = 904704
#non emb params = 820608
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step       50 | time:  3.17s | valid loss  5.60 | valid ppl   270.885
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      100 | time:  2.52s | valid loss  5.79 | valid ppl   327.801
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      150 | time:  2.51s | valid loss  6.20 | valid ppl   492.595
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 51.70 | loss  0.29 | ppl     1.334
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      200 | time:  2.52s | valid loss  6.97 | valid ppl  1063.721
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      250 | time:  2.52s | valid loss  8.05 | valid ppl  3133.868
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      300 | time:  2.54s | valid loss  8.80 | valid ppl  6610.969
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      350 | time:  2.54s | valid loss  9.32 | valid ppl 11121.876
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 51.00 | loss  0.01 | ppl     1.009
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      400 | time:  2.56s | valid loss  9.72 | valid ppl 16567.879
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      450 | time:  2.54s | valid loss 10.04 | valid ppl 22813.057
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step      500 | time:  2.53s | valid loss 10.30 | valid ppl 29746.758
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step      550 | time:  2.55s | valid loss 10.54 | valid ppl 37694.470
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 51.60 | loss  0.00 | ppl     1.002
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step      600 | time:  2.64s | valid loss 10.74 | valid ppl 45971.256
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step      650 | time:  2.55s | valid loss 10.92 | valid ppl 55126.935
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step      700 | time:  2.56s | valid loss 11.08 | valid ppl 64968.697
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step      750 | time:  2.55s | valid loss 11.23 | valid ppl 75302.636
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 51.32 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step      800 | time:  2.57s | valid loss 11.37 | valid ppl 86361.422
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step      850 | time:  2.55s | valid loss 11.50 | valid ppl 98359.095
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step      900 | time:  2.56s | valid loss 11.61 | valid ppl 110703.041
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step      950 | time:  2.56s | valid loss 11.73 | valid ppl 123659.289
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 51.54 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     1000 | time:  2.57s | valid loss 11.83 | valid ppl 137421.710
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     1050 | time:  2.58s | valid loss 11.93 | valid ppl 151853.503
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     1100 | time:  2.56s | valid loss 12.03 | valid ppl 166922.345
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     1150 | time:  2.64s | valid loss 12.12 | valid ppl 182878.926
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 52.15 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     1200 | time:  2.60s | valid loss 12.20 | valid ppl 199237.592
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     1250 | time:  2.56s | valid loss 12.29 | valid ppl 216627.891
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     1300 | time:  2.58s | valid loss 12.37 | valid ppl 234855.012
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     1350 | time:  2.57s | valid loss 12.44 | valid ppl 253518.607
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 51.70 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     1400 | time:  2.58s | valid loss 12.52 | valid ppl 273368.441
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     1450 | time:  2.59s | valid loss 12.59 | valid ppl 293659.060
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     1500 | time:  2.57s | valid loss 12.66 | valid ppl 314719.266
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     1550 | time:  2.58s | valid loss 12.73 | valid ppl 336681.103
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 51.86 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     1600 | time:  2.59s | valid loss 12.79 | valid ppl 360044.477
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     1650 | time:  2.58s | valid loss 12.86 | valid ppl 383967.297
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     1700 | time:  2.59s | valid loss 12.92 | valid ppl 408820.216
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     1750 | time:  2.67s | valid loss 12.98 | valid ppl 434450.068
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 52.50 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     1800 | time:  2.61s | valid loss 13.04 | valid ppl 461086.712
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     1850 | time:  2.59s | valid loss 13.10 | valid ppl 489189.257
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     1900 | time:  2.61s | valid loss 13.16 | valid ppl 517473.917
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     1950 | time:  2.60s | valid loss 13.21 | valid ppl 548395.544
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 52.42 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     2000 | time:  2.62s | valid loss 13.27 | valid ppl 578864.729
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     2050 | time:  2.61s | valid loss 13.32 | valid ppl 610936.753
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     2100 | time:  2.59s | valid loss 13.38 | valid ppl 644166.744
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     2150 | time:  2.61s | valid loss 13.43 | valid ppl 678207.778
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 52.35 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     2200 | time:  2.61s | valid loss 13.48 | valid ppl 713879.301
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     2250 | time:  2.60s | valid loss 13.53 | valid ppl 752011.616
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     2300 | time:  2.63s | valid loss 13.58 | valid ppl 790706.935
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  47 at step     2350 | time:  2.68s | valid loss 13.63 | valid ppl 829138.517
----------------------------------------------------------------------------------------------------
| epoch   1 step     2400 |   2400 batches | lr 0.0001 | ms/batch 52.88 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  48 at step     2400 | time:  2.61s | valid loss 13.68 | valid ppl 870348.395
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  49 at step     2450 | time:  2.63s | valid loss 13.72 | valid ppl 912695.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  50 at step     2500 | time:  2.62s | valid loss 13.77 | valid ppl 956203.533
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  51 at step     2550 | time:  2.63s | valid loss 13.82 | valid ppl 1001208.368
----------------------------------------------------------------------------------------------------
| epoch   1 step     2600 |   2600 batches | lr 0.0001 | ms/batch 52.82 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  52 at step     2600 | time:  2.65s | valid loss 13.86 | valid ppl 1047583.790
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  53 at step     2650 | time:  2.63s | valid loss 13.91 | valid ppl 1096123.226
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  54 at step     2700 | time:  2.65s | valid loss 13.95 | valid ppl 1145793.504
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  55 at step     2750 | time:  2.63s | valid loss 14.00 | valid ppl 1197125.046
----------------------------------------------------------------------------------------------------
| epoch   1 step     2800 |   2800 batches | lr 0.0001 | ms/batch 53.00 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  56 at step     2800 | time:  2.64s | valid loss 14.04 | valid ppl 1251143.225
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  57 at step     2850 | time:  2.64s | valid loss 14.08 | valid ppl 1307545.285
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  58 at step     2900 | time:  2.74s | valid loss 14.13 | valid ppl 1363943.863
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  59 at step     2950 | time:  2.64s | valid loss 14.17 | valid ppl 1423163.587
----------------------------------------------------------------------------------------------------
| epoch   1 step     3000 |   3000 batches | lr 0.0001 | ms/batch 53.63 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  60 at step     3000 | time:  2.65s | valid loss 14.21 | valid ppl 1482528.316
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  61 at step     3050 | time:  2.66s | valid loss 14.25 | valid ppl 1545308.168
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  62 at step     3100 | time:  2.66s | valid loss 14.29 | valid ppl 1609925.735
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  63 at step     3150 | time:  2.65s | valid loss 14.33 | valid ppl 1677187.244
----------------------------------------------------------------------------------------------------
| epoch   1 step     3200 |   3200 batches | lr 0.0001 | ms/batch 53.51 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  64 at step     3200 | time:  2.68s | valid loss 14.37 | valid ppl 1747074.305
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  65 at step     3250 | time:  2.66s | valid loss 14.41 | valid ppl 1818134.777
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  66 at step     3300 | time:  2.66s | valid loss 14.45 | valid ppl 1891517.214
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  67 at step     3350 | time:  2.67s | valid loss 14.49 | valid ppl 1969568.804
----------------------------------------------------------------------------------------------------
| epoch   1 step     3400 |   3400 batches | lr 0.0001 | ms/batch 53.53 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  68 at step     3400 | time:  2.68s | valid loss 14.53 | valid ppl 2047810.639
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  69 at step     3450 | time:  2.76s | valid loss 14.57 | valid ppl 2128730.718
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  70 at step     3500 | time:  2.69s | valid loss 14.61 | valid ppl 2212727.892
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  71 at step     3550 | time:  2.67s | valid loss 14.65 | valid ppl 2300001.809
----------------------------------------------------------------------------------------------------
| epoch   1 step     3600 |   3600 batches | lr 0.0001 | ms/batch 54.25 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  72 at step     3600 | time:  2.69s | valid loss 14.69 | valid ppl 2389721.599
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  73 at step     3650 | time:  2.68s | valid loss 14.72 | valid ppl 2481232.987
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  74 at step     3700 | time:  2.68s | valid loss 14.76 | valid ppl 2576119.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  75 at step     3750 | time:  2.69s | valid loss 14.80 | valid ppl 2672955.265
----------------------------------------------------------------------------------------------------
| epoch   1 step     3800 |   3800 batches | lr 0.0001 | ms/batch 53.97 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  76 at step     3800 | time:  2.70s | valid loss 14.84 | valid ppl 2777408.261
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  77 at step     3850 | time:  2.69s | valid loss 14.87 | valid ppl 2882871.240
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  78 at step     3900 | time:  2.69s | valid loss 14.91 | valid ppl 2991404.555
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  79 at step     3950 | time:  2.74s | valid loss 14.95 | valid ppl 3101076.019
----------------------------------------------------------------------------------------------------
| epoch   1 step     4000 |   4000 batches | lr 0.0001 | ms/batch 54.52 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  80 at step     4000 | time:  2.81s | valid loss 14.98 | valid ppl 3213517.415
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  81 at step     4050 | time:  2.75s | valid loss 15.02 | valid ppl 3332143.023
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  82 at step     4100 | time:  2.74s | valid loss 15.06 | valid ppl 3457337.395
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  83 at step     4150 | time:  2.75s | valid loss 15.09 | valid ppl 3581824.297
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 0.0001 | ms/batch 55.66 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  84 at step     4200 | time:  2.78s | valid loss 15.13 | valid ppl 3713831.014
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  85 at step     4250 | time:  2.76s | valid loss 15.16 | valid ppl 3849568.428
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  86 at step     4300 | time:  2.75s | valid loss 15.20 | valid ppl 3988783.400
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  87 at step     4350 | time:  2.76s | valid loss 15.23 | valid ppl 4130387.627
----------------------------------------------------------------------------------------------------
| epoch   1 step     4400 |   4400 batches | lr 0.0001 | ms/batch 55.35 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  88 at step     4400 | time:  2.77s | valid loss 15.27 | valid ppl 4277949.792
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  89 at step     4450 | time:  2.76s | valid loss 15.30 | valid ppl 4431441.808
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  90 at step     4500 | time:  2.77s | valid loss 15.34 | valid ppl 4591885.635
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  91 at step     4550 | time:  2.85s | valid loss 15.37 | valid ppl 4751285.368
----------------------------------------------------------------------------------------------------
| epoch   1 step     4600 |   4600 batches | lr 0.0001 | ms/batch 56.10 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  92 at step     4600 | time:  2.79s | valid loss 15.41 | valid ppl 4920495.487
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  93 at step     4650 | time:  2.79s | valid loss 15.44 | valid ppl 5090036.711
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  94 at step     4700 | time:  2.78s | valid loss 15.48 | valid ppl 5274498.316
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  95 at step     4750 | time:  2.78s | valid loss 15.51 | valid ppl 5460461.881
----------------------------------------------------------------------------------------------------
| epoch   1 step     4800 |   4800 batches | lr 0.0001 | ms/batch 56.05 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  96 at step     4800 | time:  2.81s | valid loss 15.55 | valid ppl 5653419.973
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  97 at step     4850 | time:  2.79s | valid loss 15.58 | valid ppl 5845824.552
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  98 at step     4900 | time:  2.80s | valid loss 15.61 | valid ppl 6046341.359
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  99 at step     4950 | time:  2.81s | valid loss 15.65 | valid ppl 6254975.512
----------------------------------------------------------------------------------------------------
| epoch   1 step     5000 |   5000 batches | lr 0.0001 | ms/batch 56.32 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 100 at step     5000 | time:  2.80s | valid loss 15.68 | valid ppl 6471184.344
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 101 at step     5050 | time:  2.83s | valid loss 15.72 | valid ppl 6692318.460
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 102 at step     5100 | time:  2.87s | valid loss 15.75 | valid ppl 6920868.876
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 103 at step     5150 | time:  2.81s | valid loss 15.78 | valid ppl 7161866.142
----------------------------------------------------------------------------------------------------
| epoch   1 step     5200 |   5200 batches | lr 0.0001 | ms/batch 56.96 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 104 at step     5200 | time:  2.85s | valid loss 15.82 | valid ppl 7402457.075
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 105 at step     5250 | time:  2.82s | valid loss 15.85 | valid ppl 7654746.184
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 106 at step     5300 | time:  2.83s | valid loss 15.88 | valid ppl 7909692.412
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 107 at step     5350 | time:  2.85s | valid loss 15.92 | valid ppl 8174576.107
----------------------------------------------------------------------------------------------------
| epoch   1 step     5400 |   5400 batches | lr 0.0001 | ms/batch 56.91 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 108 at step     5400 | time:  2.83s | valid loss 15.95 | valid ppl 8456823.273
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 109 at step     5450 | time:  2.84s | valid loss 15.98 | valid ppl 8738680.036
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 110 at step     5500 | time:  2.83s | valid loss 16.02 | valid ppl 9034560.191
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 111 at step     5550 | time:  2.84s | valid loss 16.05 | valid ppl 9335415.001
----------------------------------------------------------------------------------------------------
| epoch   1 step     5600 |   5600 batches | lr 0.0001 | ms/batch 57.05 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 112 at step     5600 | time:  2.86s | valid loss 16.08 | valid ppl 9638656.648
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 113 at step     5650 | time:  2.92s | valid loss 16.12 | valid ppl 9969557.984
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 114 at step     5700 | time:  2.86s | valid loss 16.15 | valid ppl 10302735.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 115 at step     5750 | time:  2.86s | valid loss 16.18 | valid ppl 10643901.183
----------------------------------------------------------------------------------------------------
| epoch   1 step     5800 |   5800 batches | lr 0.0001 | ms/batch 57.69 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 116 at step     5800 | time:  2.87s | valid loss 16.21 | valid ppl 11005531.179
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 117 at step     5850 | time:  2.89s | valid loss 16.25 | valid ppl 11366436.711
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 118 at step     5900 | time:  2.85s | valid loss 16.28 | valid ppl 11747080.451
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 119 at step     5950 | time:  2.88s | valid loss 16.31 | valid ppl 12136459.511
----------------------------------------------------------------------------------------------------
| epoch   1 step     6000 |   6000 batches | lr 0.0001 | ms/batch 57.79 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 120 at step     6000 | time:  2.89s | valid loss 16.34 | valid ppl 12537176.497
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 121 at step     6050 | time:  2.88s | valid loss 16.38 | valid ppl 12945114.538
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 122 at step     6100 | time:  2.90s | valid loss 16.41 | valid ppl 13367147.117
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 123 at step     6150 | time:  2.95s | valid loss 16.44 | valid ppl 13808277.769
----------------------------------------------------------------------------------------------------
| epoch   1 step     6200 |   6200 batches | lr 0.0001 | ms/batch 58.47 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 124 at step     6200 | time:  2.92s | valid loss 16.47 | valid ppl 14269370.426
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 125 at step     6250 | time:  2.89s | valid loss 16.51 | valid ppl 14729806.947
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 126 at step     6300 | time:  2.90s | valid loss 16.54 | valid ppl 15213773.331
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 127 at step     6350 | time:  2.89s | valid loss 16.57 | valid ppl 15714527.020
----------------------------------------------------------------------------------------------------
| epoch   1 step     6400 |   6400 batches | lr 0.0001 | ms/batch 58.11 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 128 at step     6400 | time:  2.87s | valid loss 16.60 | valid ppl 16226371.111
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 129 at step     6450 | time:  2.87s | valid loss 16.63 | valid ppl 16746041.925
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 130 at step     6500 | time:  5.78s | valid loss 16.67 | valid ppl 17288058.842
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 131 at step     6550 | time:  2.92s | valid loss 16.70 | valid ppl 17855415.023
----------------------------------------------------------------------------------------------------
| epoch   1 step     6600 |   6600 batches | lr 0.0001 | ms/batch 72.53 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 132 at step     6600 | time:  2.94s | valid loss 16.73 | valid ppl 18434930.931
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 133 at step     6650 | time:  2.87s | valid loss 16.76 | valid ppl 19044132.223
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 134 at step     6700 | time:  2.89s | valid loss 16.79 | valid ppl 19661030.623
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 135 at step     6750 | time:  2.91s | valid loss 16.83 | valid ppl 20293182.600
----------------------------------------------------------------------------------------------------
| epoch   1 step     6800 |   6800 batches | lr 0.0001 | ms/batch 58.41 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 136 at step     6800 | time:  2.92s | valid loss 16.86 | valid ppl 20936071.503
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 137 at step     6850 | time:  2.92s | valid loss 16.89 | valid ppl 21614333.178
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 138 at step     6900 | time:  2.91s | valid loss 16.92 | valid ppl 22311981.612
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 139 at step     6950 | time:  2.92s | valid loss 16.95 | valid ppl 23016125.282
----------------------------------------------------------------------------------------------------
| epoch   1 step     7000 |   7000 batches | lr 0.0001 | ms/batch 58.61 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 140 at step     7000 | time:  2.92s | valid loss 16.98 | valid ppl 23768594.163
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 141 at step     7050 | time:  2.96s | valid loss 17.02 | valid ppl 24531920.063
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 142 at step     7100 | time:  2.94s | valid loss 17.05 | valid ppl 25318408.875
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 143 at step     7150 | time:  2.99s | valid loss 17.08 | valid ppl 26134943.237
----------------------------------------------------------------------------------------------------
| epoch   1 step     7200 |   7200 batches | lr 0.0001 | ms/batch 59.42 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 144 at step     7200 | time:  2.94s | valid loss 17.11 | valid ppl 26988449.409
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 145 at step     7250 | time:  3.03s | valid loss 17.14 | valid ppl 27839341.897
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 146 at step     7300 | time:  2.94s | valid loss 17.17 | valid ppl 28724161.956
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 147 at step     7350 | time:  2.96s | valid loss 17.20 | valid ppl 29617436.745
----------------------------------------------------------------------------------------------------
| epoch   1 step     7400 |   7400 batches | lr 0.0001 | ms/batch 59.67 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 148 at step     7400 | time:  2.94s | valid loss 17.24 | valid ppl 30592606.525
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 149 at step     7450 | time:  2.95s | valid loss 17.27 | valid ppl 31545066.291
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 150 at step     7500 | time:  2.96s | valid loss 17.30 | valid ppl 32546037.998
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 151 at step     7550 | time:  2.97s | valid loss 17.33 | valid ppl 33599223.147
----------------------------------------------------------------------------------------------------
| epoch   1 step     7600 |   7600 batches | lr 0.0001 | ms/batch 59.50 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 152 at step     7600 | time:  2.99s | valid loss 17.36 | valid ppl 34652400.895
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 153 at step     7650 | time:  3.03s | valid loss 17.39 | valid ppl 35780446.026
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 154 at step     7700 | time:  2.99s | valid loss 17.42 | valid ppl 36885739.514
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 155 at step     7750 | time:  2.98s | valid loss 17.45 | valid ppl 38072076.988
----------------------------------------------------------------------------------------------------
| epoch   1 step     7800 |   7800 batches | lr 0.0001 | ms/batch 60.13 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 156 at step     7800 | time:  2.97s | valid loss 17.49 | valid ppl 39235556.845
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 157 at step     7850 | time:  3.01s | valid loss 17.52 | valid ppl 40510568.172
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 158 at step     7900 | time:  2.98s | valid loss 17.55 | valid ppl 41722047.343
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 159 at step     7950 | time:  3.00s | valid loss 17.58 | valid ppl 43001305.249
----------------------------------------------------------------------------------------------------
| epoch   1 step     8000 |   8000 batches | lr 0.0001 | ms/batch 60.14 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 160 at step     8000 | time:  2.99s | valid loss 17.61 | valid ppl 44421732.906
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 161 at step     8050 | time:  2.99s | valid loss 17.64 | valid ppl 45827062.585
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 162 at step     8100 | time:  3.00s | valid loss 17.67 | valid ppl 47286288.082
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 163 at step     8150 | time:  3.08s | valid loss 17.70 | valid ppl 48740106.288
----------------------------------------------------------------------------------------------------
| epoch   1 step     8200 |   8200 batches | lr 0.0001 | ms/batch 60.71 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 164 at step     8200 | time:  3.01s | valid loss 17.73 | valid ppl 50283003.781
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 165 at step     8250 | time:  3.03s | valid loss 17.76 | valid ppl 51850208.532
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 166 at step     8300 | time:  3.01s | valid loss 17.80 | valid ppl 53502002.698
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 167 at step     8350 | time:  3.03s | valid loss 17.83 | valid ppl 55125549.681
----------------------------------------------------------------------------------------------------
| epoch   1 step     8400 |   8400 batches | lr 0.0001 | ms/batch 60.67 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 168 at step     8400 | time:  3.02s | valid loss 17.86 | valid ppl 56820186.784
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 169 at step     8450 | time:  3.01s | valid loss 17.89 | valid ppl 58676154.956
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 170 at step     8500 | time:  3.01s | valid loss 17.92 | valid ppl 60493997.012
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 171 at step     8550 | time:  3.04s | valid loss 17.95 | valid ppl 62370429.647
----------------------------------------------------------------------------------------------------
| epoch   1 step     8600 |   8600 batches | lr 0.0001 | ms/batch 60.79 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 172 at step     8600 | time:  3.04s | valid loss 17.98 | valid ppl 64322752.818
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 173 at step     8650 | time:  3.10s | valid loss 18.01 | valid ppl 66373237.368
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 174 at step     8700 | time:  3.05s | valid loss 18.04 | valid ppl 68509631.131
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 175 at step     8750 | time:  3.04s | valid loss 18.07 | valid ppl 70597519.653
----------------------------------------------------------------------------------------------------
| epoch   1 step     8800 |   8800 batches | lr 0.0001 | ms/batch 61.33 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 176 at step     8800 | time:  3.05s | valid loss 18.10 | valid ppl 72755338.207
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 177 at step     8850 | time:  3.05s | valid loss 18.13 | valid ppl 75003040.258
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 178 at step     8900 | time:  3.05s | valid loss 18.16 | valid ppl 77281559.469
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 179 at step     8950 | time:  3.06s | valid loss 18.19 | valid ppl 79641406.731
----------------------------------------------------------------------------------------------------
| epoch   1 step     9000 |   9000 batches | lr 0.0001 | ms/batch 61.30 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 180 at step     9000 | time:  3.05s | valid loss 18.22 | valid ppl 82126652.408
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 181 at step     9050 | time:  3.06s | valid loss 18.25 | valid ppl 84694462.168
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 182 at step     9100 | time:  3.06s | valid loss 18.28 | valid ppl 87258922.134
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 183 at step     9150 | time:  3.18s | valid loss 18.32 | valid ppl 90029885.739
----------------------------------------------------------------------------------------------------
| epoch   1 step     9200 |   9200 batches | lr 0.0001 | ms/batch 62.09 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 184 at step     9200 | time:  3.08s | valid loss 18.35 | valid ppl 92827937.361
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 185 at step     9250 | time:  3.09s | valid loss 18.38 | valid ppl 95793148.461
----------------------------------------------------------------------------------------------------
