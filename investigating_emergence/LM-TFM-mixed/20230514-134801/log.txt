Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : mixed
    - n_layer : 2
    - n_head : 6
    - d_head : 128
    - d_embed : 128
    - d_model : 128
    - d_inner : 64
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 128
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 50
    - work_dir : LM-TFM-mixed/20230514-134801
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 1
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - tied : True
    - n_token : 256
    - n_all_param : 904704
    - n_nonemb_param : 820608
====================================================================================================
#params = 904704
#non emb params = 820608
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step       50 | time:  3.16s | valid loss  5.15 | valid ppl   171.949
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      100 | time:  2.52s | valid loss  5.93 | valid ppl   374.509
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      150 | time:  2.52s | valid loss  6.94 | valid ppl  1031.117
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 51.54 | loss  0.32 | ppl     1.377
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      200 | time:  2.55s | valid loss  8.10 | valid ppl  3283.231
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      250 | time:  2.56s | valid loss  9.06 | valid ppl  8637.250
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      300 | time:  2.56s | valid loss  9.60 | valid ppl 14744.720
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      350 | time:  2.53s | valid loss 10.03 | valid ppl 22803.962
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 51.15 | loss  0.02 | ppl     1.021
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      400 | time:  2.55s | valid loss 10.25 | valid ppl 28401.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      450 | time:  2.54s | valid loss 10.41 | valid ppl 33151.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step      500 | time:  2.54s | valid loss 10.64 | valid ppl 41876.780
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step      550 | time:  2.59s | valid loss 10.74 | valid ppl 46291.201
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 51.92 | loss  0.01 | ppl     1.005
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step      600 | time:  2.71s | valid loss 10.80 | valid ppl 49230.159
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step      650 | time:  2.55s | valid loss 10.97 | valid ppl 57818.188
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step      700 | time:  2.58s | valid loss 11.03 | valid ppl 61795.757
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step      750 | time:  2.58s | valid loss 11.06 | valid ppl 63374.127
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 51.42 | loss  0.00 | ppl     1.003
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step      800 | time:  2.56s | valid loss 11.17 | valid ppl 71215.648
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step      850 | time:  2.54s | valid loss 11.20 | valid ppl 73482.837
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step      900 | time:  2.57s | valid loss 11.20 | valid ppl 73147.195
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step      950 | time:  2.60s | valid loss 11.27 | valid ppl 78674.222
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 51.56 | loss  0.00 | ppl     1.002
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     1000 | time:  2.60s | valid loss 11.31 | valid ppl 81724.141
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     1050 | time:  2.59s | valid loss 11.27 | valid ppl 78502.277
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     1100 | time:  2.59s | valid loss 11.33 | valid ppl 83654.249
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     1150 | time:  2.61s | valid loss 11.35 | valid ppl 84586.785
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 52.52 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     1200 | time:  2.69s | valid loss 11.31 | valid ppl 81590.748
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     1250 | time:  2.59s | valid loss 11.35 | valid ppl 85033.492
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     1300 | time:  2.60s | valid loss 11.34 | valid ppl 84449.464
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     1350 | time:  2.60s | valid loss 11.29 | valid ppl 79994.747
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 51.97 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     1400 | time:  2.60s | valid loss 11.29 | valid ppl 80332.957
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     1450 | time:  2.61s | valid loss 11.29 | valid ppl 80395.943
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     1500 | time:  2.59s | valid loss 11.22 | valid ppl 74901.739
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     1550 | time:  2.61s | valid loss 11.22 | valid ppl 74268.742
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 52.25 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     1600 | time:  2.63s | valid loss 11.20 | valid ppl 73202.671
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     1650 | time:  2.64s | valid loss 11.14 | valid ppl 68712.614
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     1700 | time:  2.63s | valid loss 11.13 | valid ppl 68102.339
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     1750 | time:  2.70s | valid loss 11.13 | valid ppl 67912.701
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 52.93 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     1800 | time:  2.60s | valid loss 11.07 | valid ppl 63904.542
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     1850 | time:  2.61s | valid loss 11.05 | valid ppl 62896.679
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     1900 | time:  2.62s | valid loss 11.07 | valid ppl 64373.338
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     1950 | time:  2.61s | valid loss 11.03 | valid ppl 61841.297
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 52.38 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     2000 | time:  2.61s | valid loss 11.02 | valid ppl 61314.273
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     2050 | time:  2.63s | valid loss 11.06 | valid ppl 63509.588
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     2100 | time:  2.63s | valid loss 11.04 | valid ppl 62616.039
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     2150 | time:  2.64s | valid loss 11.03 | valid ppl 61702.206
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 52.65 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     2200 | time:  2.62s | valid loss 11.08 | valid ppl 65081.873
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     2250 | time:  2.62s | valid loss 11.09 | valid ppl 65263.811
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     2300 | time:  2.64s | valid loss 11.08 | valid ppl 64859.249
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  47 at step     2350 | time:  2.70s | valid loss 11.14 | valid ppl 68897.256
----------------------------------------------------------------------------------------------------
| epoch   1 step     2400 |   2400 batches | lr 0.0001 | ms/batch 52.98 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  48 at step     2400 | time:  2.61s | valid loss 11.16 | valid ppl 70380.752
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  49 at step     2450 | time:  2.63s | valid loss 11.15 | valid ppl 69810.817
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  50 at step     2500 | time:  2.64s | valid loss 11.22 | valid ppl 74241.688
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  51 at step     2550 | time:  2.65s | valid loss 11.25 | valid ppl 76580.132
----------------------------------------------------------------------------------------------------
| epoch   1 step     2600 |   2600 batches | lr 0.0001 | ms/batch 52.90 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  52 at step     2600 | time:  2.68s | valid loss 11.24 | valid ppl 76338.532
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  53 at step     2650 | time:  2.62s | valid loss 11.31 | valid ppl 81810.423
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  54 at step     2700 | time:  2.67s | valid loss 11.35 | valid ppl 85324.958
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  55 at step     2750 | time:  2.69s | valid loss 11.34 | valid ppl 84044.404
----------------------------------------------------------------------------------------------------
| epoch   1 step     2800 |   2800 batches | lr 0.0001 | ms/batch 53.43 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  56 at step     2800 | time:  2.68s | valid loss 11.41 | valid ppl 89918.930
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  57 at step     2850 | time:  2.69s | valid loss 11.45 | valid ppl 93583.702
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  58 at step     2900 | time:  2.78s | valid loss 11.43 | valid ppl 92064.254
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  59 at step     2950 | time:  2.70s | valid loss 11.49 | valid ppl 97924.527
----------------------------------------------------------------------------------------------------
| epoch   1 step     3000 |   3000 batches | lr 0.0001 | ms/batch 54.45 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  60 at step     3000 | time:  2.70s | valid loss 11.54 | valid ppl 103070.750
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  61 at step     3050 | time:  2.68s | valid loss 11.52 | valid ppl 101003.191
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  62 at step     3100 | time:  2.71s | valid loss 11.58 | valid ppl 107433.555
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  63 at step     3150 | time:  2.71s | valid loss 11.63 | valid ppl 112905.119
----------------------------------------------------------------------------------------------------
| epoch   1 step     3200 |   3200 batches | lr 0.0001 | ms/batch 54.10 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  64 at step     3200 | time:  2.70s | valid loss 11.61 | valid ppl 109723.345
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  65 at step     3250 | time:  2.71s | valid loss 11.67 | valid ppl 117207.983
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  66 at step     3300 | time:  2.70s | valid loss 11.72 | valid ppl 122458.395
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  67 at step     3350 | time:  2.67s | valid loss 11.68 | valid ppl 118596.918
----------------------------------------------------------------------------------------------------
| epoch   1 step     3400 |   3400 batches | lr 0.0001 | ms/batch 54.00 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  68 at step     3400 | time:  2.71s | valid loss 11.74 | valid ppl 125768.515
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  69 at step     3450 | time:  2.78s | valid loss 11.79 | valid ppl 131872.710
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  70 at step     3500 | time:  2.71s | valid loss 11.75 | valid ppl 126756.615
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  71 at step     3550 | time:  2.71s | valid loss 11.81 | valid ppl 134258.778
----------------------------------------------------------------------------------------------------
| epoch   1 step     3600 |   3600 batches | lr 0.0001 | ms/batch 54.70 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  72 at step     3600 | time:  2.72s | valid loss 11.85 | valid ppl 140344.195
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  73 at step     3650 | time:  2.70s | valid loss 11.81 | valid ppl 134292.905
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  74 at step     3700 | time:  2.72s | valid loss 11.87 | valid ppl 142208.614
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  75 at step     3750 | time:  2.74s | valid loss 11.91 | valid ppl 148607.553
----------------------------------------------------------------------------------------------------
| epoch   1 step     3800 |   3800 batches | lr 0.0001 | ms/batch 54.35 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  76 at step     3800 | time:  2.70s | valid loss 11.87 | valid ppl 142237.670
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  77 at step     3850 | time:  2.71s | valid loss 11.92 | valid ppl 150293.136
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  78 at step     3900 | time:  2.72s | valid loss 11.97 | valid ppl 157182.500
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  79 at step     3950 | time:  2.77s | valid loss 11.91 | valid ppl 149487.702
----------------------------------------------------------------------------------------------------
| epoch   1 step     4000 |   4000 batches | lr 0.0001 | ms/batch 55.25 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  80 at step     4000 | time:  2.85s | valid loss 11.96 | valid ppl 156896.079
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  81 at step     4050 | time:  2.77s | valid loss 12.01 | valid ppl 165179.641
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  82 at step     4100 | time:  2.74s | valid loss 11.96 | valid ppl 156494.553
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  83 at step     4150 | time:  2.75s | valid loss 12.02 | valid ppl 165589.633
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 0.0001 | ms/batch 55.09 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  84 at step     4200 | time:  2.74s | valid loss 12.07 | valid ppl 174316.533
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  85 at step     4250 | time:  2.77s | valid loss 12.01 | valid ppl 164451.884
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  86 at step     4300 | time:  2.77s | valid loss 12.06 | valid ppl 173559.745
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  87 at step     4350 | time:  2.75s | valid loss 12.11 | valid ppl 181325.450
----------------------------------------------------------------------------------------------------
| epoch   1 step     4400 |   4400 batches | lr 0.0001 | ms/batch 55.14 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  88 at step     4400 | time:  2.74s | valid loss 12.05 | valid ppl 170585.367
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  89 at step     4450 | time:  2.78s | valid loss 12.10 | valid ppl 180425.081
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  90 at step     4500 | time:  2.80s | valid loss 12.15 | valid ppl 189232.717
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  91 at step     4550 | time:  2.86s | valid loss 12.09 | valid ppl 178280.014
----------------------------------------------------------------------------------------------------
| epoch   1 step     4600 |   4600 batches | lr 0.0001 | ms/batch 56.15 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  92 at step     4600 | time:  2.73s | valid loss 12.15 | valid ppl 188624.546
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  93 at step     4650 | time:  2.67s | valid loss 12.20 | valid ppl 198519.793
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  94 at step     4700 | time:  2.67s | valid loss 12.13 | valid ppl 185183.446
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  95 at step     4750 | time:  2.69s | valid loss 12.18 | valid ppl 195369.217
----------------------------------------------------------------------------------------------------
| epoch   1 step     4800 |   4800 batches | lr 0.0001 | ms/batch 53.96 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  96 at step     4800 | time:  2.80s | valid loss 12.24 | valid ppl 206870.535
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  97 at step     4850 | time:  2.76s | valid loss 12.17 | valid ppl 191953.917
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  98 at step     4900 | time:  2.75s | valid loss 12.23 | valid ppl 203859.601
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  99 at step     4950 | time:  2.78s | valid loss 12.27 | valid ppl 213953.044
----------------------------------------------------------------------------------------------------
| epoch   1 step     5000 |   5000 batches | lr 0.0001 | ms/batch 55.36 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 100 at step     5000 | time:  2.78s | valid loss 12.20 | valid ppl 199042.459
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 101 at step     5050 | time:  2.79s | valid loss 12.26 | valid ppl 211101.149
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 102 at step     5100 | time:  2.85s | valid loss 12.32 | valid ppl 223188.899
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 103 at step     5150 | time:  2.77s | valid loss 12.24 | valid ppl 206362.617
----------------------------------------------------------------------------------------------------
| epoch   1 step     5200 |   5200 batches | lr 0.0001 | ms/batch 56.25 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 104 at step     5200 | time:  2.83s | valid loss 12.29 | valid ppl 218277.243
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 105 at step     5250 | time:  2.84s | valid loss 12.35 | valid ppl 231135.018
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 106 at step     5300 | time:  2.83s | valid loss 12.27 | valid ppl 213666.101
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 107 at step     5350 | time:  2.84s | valid loss 12.33 | valid ppl 226362.168
----------------------------------------------------------------------------------------------------
| epoch   1 step     5400 |   5400 batches | lr 0.0001 | ms/batch 56.90 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 108 at step     5400 | time:  2.87s | valid loss 12.39 | valid ppl 240063.739
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 109 at step     5450 | time:  2.80s | valid loss 12.31 | valid ppl 221022.040
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 110 at step     5500 | time:  2.83s | valid loss 12.36 | valid ppl 234427.886
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 111 at step     5550 | time:  2.81s | valid loss 12.42 | valid ppl 248268.723
----------------------------------------------------------------------------------------------------
| epoch   1 step     5600 |   5600 batches | lr 0.0001 | ms/batch 56.64 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 112 at step     5600 | time:  2.87s | valid loss 12.34 | valid ppl 227540.005
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 113 at step     5650 | time:  2.94s | valid loss 12.40 | valid ppl 241663.779
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 114 at step     5700 | time:  2.85s | valid loss 12.46 | valid ppl 257505.065
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 115 at step     5750 | time:  2.87s | valid loss 12.36 | valid ppl 234428.691
----------------------------------------------------------------------------------------------------
| epoch   1 step     5800 |   5800 batches | lr 0.0001 | ms/batch 57.71 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 116 at step     5800 | time:  2.89s | valid loss 12.43 | valid ppl 250279.534
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 117 at step     5850 | time:  2.89s | valid loss 12.49 | valid ppl 266475.078
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 118 at step     5900 | time:  2.89s | valid loss 12.40 | valid ppl 242352.245
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 119 at step     5950 | time:  2.89s | valid loss 12.46 | valid ppl 257416.806
----------------------------------------------------------------------------------------------------
| epoch   1 step     6000 |   6000 batches | lr 0.0001 | ms/batch 57.88 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 120 at step     6000 | time:  2.89s | valid loss 12.52 | valid ppl 274432.501
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 121 at step     6050 | time:  2.88s | valid loss 12.43 | valid ppl 249874.990
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 122 at step     6100 | time:  2.84s | valid loss 12.49 | valid ppl 265335.521
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 123 at step     6150 | time:  5.90s | valid loss 12.56 | valid ppl 284286.993
----------------------------------------------------------------------------------------------------
| epoch   1 step     6200 |   6200 batches | lr 0.0001 | ms/batch 72.77 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 124 at step     6200 | time:  2.91s | valid loss 12.46 | valid ppl 257438.852
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 125 at step     6250 | time:  2.89s | valid loss 12.53 | valid ppl 275227.004
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 126 at step     6300 | time:  2.88s | valid loss 12.59 | valid ppl 294370.184
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 127 at step     6350 | time:  2.89s | valid loss 12.49 | valid ppl 265304.565
----------------------------------------------------------------------------------------------------
| epoch   1 step     6400 |   6400 batches | lr 0.0001 | ms/batch 57.94 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 128 at step     6400 | time:  2.92s | valid loss 12.55 | valid ppl 282705.492
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 129 at step     6450 | time:  2.92s | valid loss 12.63 | valid ppl 305772.278
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 130 at step     6500 | time:  2.89s | valid loss 12.52 | valid ppl 273708.397
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 131 at step     6550 | time:  2.93s | valid loss 12.58 | valid ppl 291608.370
----------------------------------------------------------------------------------------------------
| epoch   1 step     6600 |   6600 batches | lr 0.0001 | ms/batch 58.48 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 132 at step     6600 | time:  2.95s | valid loss 12.66 | valid ppl 313869.244
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 133 at step     6650 | time:  3.00s | valid loss 12.55 | valid ppl 282608.034
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 134 at step     6700 | time:  2.95s | valid loss 12.62 | valid ppl 301751.331
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 135 at step     6750 | time:  2.96s | valid loss 12.69 | valid ppl 324434.338
----------------------------------------------------------------------------------------------------
| epoch   1 step     6800 |   6800 batches | lr 0.0001 | ms/batch 59.26 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 136 at step     6800 | time:  2.92s | valid loss 12.58 | valid ppl 291150.933
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 137 at step     6850 | time:  2.98s | valid loss 12.65 | valid ppl 312745.514
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 138 at step     6900 | time:  2.94s | valid loss 12.72 | valid ppl 335725.375
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 139 at step     6950 | time:  2.93s | valid loss 12.61 | valid ppl 300026.165
----------------------------------------------------------------------------------------------------
| epoch   1 step     7000 |   7000 batches | lr 0.0001 | ms/batch 59.04 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 140 at step     7000 | time:  2.96s | valid loss 12.68 | valid ppl 319981.825
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 141 at step     7050 | time:  2.94s | valid loss 12.76 | valid ppl 349534.820
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 142 at step     7100 | time:  2.98s | valid loss 12.65 | valid ppl 310564.725
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 143 at step     7150 | time:  3.02s | valid loss 12.71 | valid ppl 331227.548
----------------------------------------------------------------------------------------------------
| epoch   1 step     7200 |   7200 batches | lr 0.0001 | ms/batch 59.42 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 144 at step     7200 | time:  2.92s | valid loss 12.80 | valid ppl 360680.696
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 145 at step     7250 | time:  2.97s | valid loss 12.67 | valid ppl 319114.461
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 146 at step     7300 | time:  2.99s | valid loss 12.74 | valid ppl 341960.367
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 147 at step     7350 | time:  3.00s | valid loss 12.83 | valid ppl 372867.492
----------------------------------------------------------------------------------------------------
| epoch   1 step     7400 |   7400 batches | lr 0.0001 | ms/batch 59.63 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 148 at step     7400 | time:  2.96s | valid loss 12.70 | valid ppl 328222.656
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 149 at step     7450 | time:  2.99s | valid loss 12.77 | valid ppl 352842.710
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 150 at step     7500 | time:  2.98s | valid loss 12.86 | valid ppl 385529.668
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 151 at step     7550 | time:  3.03s | valid loss 12.74 | valid ppl 340335.537
----------------------------------------------------------------------------------------------------
| epoch   1 step     7600 |   7600 batches | lr 0.0001 | ms/batch 60.24 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 152 at step     7600 | time:  3.04s | valid loss 12.80 | valid ppl 363944.555
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 153 at step     7650 | time:  3.10s | valid loss 12.89 | valid ppl 397086.329
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 154 at step     7700 | time:  3.04s | valid loss 12.77 | valid ppl 351340.926
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 155 at step     7750 | time:  3.01s | valid loss 12.85 | valid ppl 379360.355
----------------------------------------------------------------------------------------------------
| epoch   1 step     7800 |   7800 batches | lr 0.0001 | ms/batch 60.91 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 156 at step     7800 | time:  3.03s | valid loss 12.93 | valid ppl 414492.873
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 157 at step     7850 | time:  3.03s | valid loss 12.81 | valid ppl 364529.327
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 158 at step     7900 | time:  3.01s | valid loss 12.87 | valid ppl 390237.022
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 159 at step     7950 | time:  3.06s | valid loss 12.97 | valid ppl 430388.784
----------------------------------------------------------------------------------------------------
| epoch   1 step     8000 |   8000 batches | lr 0.0001 | ms/batch 60.76 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 160 at step     8000 | time:  3.01s | valid loss 12.84 | valid ppl 377920.082
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 161 at step     8050 | time:  3.04s | valid loss 12.92 | valid ppl 408493.969
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 162 at step     8100 | time:  3.03s | valid loss 13.02 | valid ppl 449643.449
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 163 at step     8150 | time:  3.12s | valid loss 12.89 | valid ppl 394616.230
----------------------------------------------------------------------------------------------------
| epoch   1 step     8200 |   8200 batches | lr 0.0001 | ms/batch 61.19 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 164 at step     8200 | time:  3.07s | valid loss 12.96 | valid ppl 424309.104
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 165 at step     8250 | time:  3.03s | valid loss 13.06 | valid ppl 469948.252
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 166 at step     8300 | time:  3.05s | valid loss 12.92 | valid ppl 409430.063
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 167 at step     8350 | time:  3.04s | valid loss 13.00 | valid ppl 443536.578
----------------------------------------------------------------------------------------------------
| epoch   1 step     8400 |   8400 batches | lr 0.0001 | ms/batch 61.07 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 168 at step     8400 | time:  3.09s | valid loss 13.10 | valid ppl 491266.023
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 169 at step     8450 | time:  3.06s | valid loss 12.97 | valid ppl 429970.353
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 170 at step     8500 | time:  3.06s | valid loss 13.04 | valid ppl 462635.677
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 171 at step     8550 | time:  3.05s | valid loss 13.15 | valid ppl 513972.990
----------------------------------------------------------------------------------------------------
| epoch   1 step     8600 |   8600 batches | lr 0.0001 | ms/batch 61.36 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 172 at step     8600 | time:  3.06s | valid loss 13.01 | valid ppl 448240.113
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 173 at step     8650 | time:  3.11s | valid loss 13.09 | valid ppl 485516.411
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 174 at step     8700 | time:  3.05s | valid loss 13.20 | valid ppl 539940.409
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 175 at step     8750 | time:  3.06s | valid loss 13.06 | valid ppl 470692.582
----------------------------------------------------------------------------------------------------
| epoch   1 step     8800 |   8800 batches | lr 0.0001 | ms/batch 61.26 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 176 at step     8800 | time:  3.02s | valid loss 13.14 | valid ppl 508445.985
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 177 at step     8850 | time:  2.96s | valid loss 13.25 | valid ppl 566116.635
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 178 at step     8900 | time:  2.95s | valid loss 13.11 | valid ppl 494114.616
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 179 at step     8950 | time:  3.09s | valid loss 13.19 | valid ppl 534350.606
----------------------------------------------------------------------------------------------------
| epoch   1 step     9000 |   9000 batches | lr 0.0001 | ms/batch 60.25 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 180 at step     9000 | time:  3.07s | valid loss 13.30 | valid ppl 596461.099
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 181 at step     9050 | time:  3.07s | valid loss 13.16 | valid ppl 519029.438
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 182 at step     9100 | time:  3.04s | valid loss 13.24 | valid ppl 564460.205
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 183 at step     9150 | time:  3.16s | valid loss 13.35 | valid ppl 630249.565
----------------------------------------------------------------------------------------------------
| epoch   1 step     9200 |   9200 batches | lr 0.0001 | ms/batch 61.77 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 184 at step     9200 | time:  3.09s | valid loss 13.21 | valid ppl 545204.039
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 185 at step     9250 | time:  3.13s | valid loss 13.29 | valid ppl 592111.541
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 186 at step     9300 | time:  3.14s | valid loss 13.41 | valid ppl 665259.667
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 187 at step     9350 | time:  3.10s | valid loss 13.26 | valid ppl 576094.498
----------------------------------------------------------------------------------------------------
| epoch   1 step     9400 |   9400 batches | lr 0.0001 | ms/batch 62.52 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 188 at step     9400 | time:  3.11s | valid loss 13.35 | valid ppl 624981.396
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 189 at step     9450 | time:  3.10s | valid loss 13.46 | valid ppl 701786.005
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 190 at step     9500 | time:  3.12s | valid loss 13.32 | valid ppl 608731.264
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 191 at step     9550 | time:  3.12s | valid loss 13.40 | valid ppl 660526.802
----------------------------------------------------------------------------------------------------
| epoch   1 step     9600 |   9600 batches | lr 0.0001 | ms/batch 62.18 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 192 at step     9600 | time:  3.13s | valid loss 13.52 | valid ppl 743638.028
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 193 at step     9650 | time:  3.13s | valid loss 13.37 | valid ppl 643451.710
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 194 at step     9700 | time:  3.12s | valid loss 13.46 | valid ppl 699453.090
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 195 at step     9750 | time:  3.12s | valid loss 13.58 | valid ppl 790259.908
----------------------------------------------------------------------------------------------------
| epoch   1 step     9800 |   9800 batches | lr 0.0001 | ms/batch 62.56 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 196 at step     9800 | time:  3.11s | valid loss 13.44 | valid ppl 683852.058
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 197 at step     9850 | time:  3.16s | valid loss 13.52 | valid ppl 744114.088
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 198 at step     9900 | time:  3.15s | valid loss 13.64 | valid ppl 840326.345
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 199 at step     9950 | time:  3.11s | valid loss 13.49 | valid ppl 724999.939
----------------------------------------------------------------------------------------------------
| epoch   1 step    10000 |  10000 batches | lr 0.0001 | ms/batch 62.92 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 200 at step    10000 | time:  3.16s | valid loss 13.58 | valid ppl 789905.034
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 201 at step    10050 | time:  3.16s | valid loss 13.71 | valid ppl 896769.779
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 202 at step    10100 | time:  3.22s | valid loss 13.55 | valid ppl 769407.184
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 203 at step    10150 | time:  3.16s | valid loss 13.64 | valid ppl 842270.184
----------------------------------------------------------------------------------------------------
| epoch   1 step    10200 |  10200 batches | lr 0.0001 | ms/batch 63.51 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 204 at step    10200 | time:  3.14s | valid loss 13.76 | valid ppl 949101.138
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 205 at step    10250 | time:  3.18s | valid loss 13.62 | valid ppl 818786.630
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 206 at step    10300 | time:  3.15s | valid loss 13.71 | valid ppl 897404.855
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 207 at step    10350 | time:  3.14s | valid loss 13.83 | valid ppl 1014011.458
----------------------------------------------------------------------------------------------------
| epoch   1 step    10400 |  10400 batches | lr 0.0001 | ms/batch 63.14 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 208 at step    10400 | time:  3.16s | valid loss 13.68 | valid ppl 871478.216
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 209 at step    10450 | time:  3.17s | valid loss 13.77 | valid ppl 952346.726
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 210 at step    10500 | time:  3.21s | valid loss 13.90 | valid ppl 1082827.105
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 211 at step    10550 | time:  3.22s | valid loss 13.74 | valid ppl 931666.366
----------------------------------------------------------------------------------------------------
| epoch   1 step    10600 |  10600 batches | lr 0.0001 | ms/batch 63.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 212 at step    10600 | time:  3.16s | valid loss 13.83 | valid ppl 1015973.091
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 213 at step    10650 | time:  3.20s | valid loss 13.96 | valid ppl 1156926.508
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 214 at step    10700 | time:  3.18s | valid loss 13.81 | valid ppl 992712.536
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 215 at step    10750 | time:  3.15s | valid loss 13.89 | valid ppl 1081612.547
----------------------------------------------------------------------------------------------------
| epoch   1 step    10800 |  10800 batches | lr 0.0001 | ms/batch 63.64 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 216 at step    10800 | time:  3.18s | valid loss 14.03 | valid ppl 1233871.097
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 217 at step    10850 | time:  3.23s | valid loss 13.88 | valid ppl 1062041.507
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 218 at step    10900 | time:  3.32s | valid loss 13.96 | valid ppl 1156946.435
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 219 at step    10950 | time:  3.59s | valid loss 14.09 | valid ppl 1317466.060
----------------------------------------------------------------------------------------------------
| epoch   1 step    11000 |  11000 batches | lr 0.0001 | ms/batch 66.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 220 at step    11000 | time:  3.56s | valid loss 13.94 | valid ppl 1133503.029
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 221 at step    11050 | time:  3.61s | valid loss 14.03 | valid ppl 1236587.980
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 222 at step    11100 | time:  3.51s | valid loss 14.16 | valid ppl 1407205.250
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 223 at step    11150 | time:  3.55s | valid loss 14.01 | valid ppl 1211234.413
----------------------------------------------------------------------------------------------------
| epoch   1 step    11200 |  11200 batches | lr 0.0001 | ms/batch 71.26 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 224 at step    11200 | time:  3.60s | valid loss 14.09 | valid ppl 1321782.356
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 225 at step    11250 | time:  3.57s | valid loss 14.22 | valid ppl 1506045.016
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 226 at step    11300 | time:  3.58s | valid loss 14.07 | valid ppl 1293419.747
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 227 at step    11350 | time:  3.56s | valid loss 14.16 | valid ppl 1413002.965
----------------------------------------------------------------------------------------------------
| epoch   1 step    11400 |  11400 batches | lr 0.0001 | ms/batch 71.47 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 228 at step    11400 | time:  3.57s | valid loss 14.29 | valid ppl 1612974.927
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 229 at step    11450 | time:  3.63s | valid loss 14.13 | valid ppl 1375926.802
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 230 at step    11500 | time:  3.58s | valid loss 14.23 | valid ppl 1506097.785
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 231 at step    11550 | time:  3.60s | valid loss 14.36 | valid ppl 1724851.622
----------------------------------------------------------------------------------------------------
| epoch   1 step    11600 |  11600 batches | lr 0.0001 | ms/batch 72.11 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 232 at step    11600 | time:  3.61s | valid loss 14.20 | valid ppl 1471949.814
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 233 at step    11650 | time:  3.56s | valid loss 14.29 | valid ppl 1614728.380
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 234 at step    11700 | time:  3.65s | valid loss 14.43 | valid ppl 1844260.601
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 235 at step    11750 | time:  3.62s | valid loss 14.27 | valid ppl 1573387.045
----------------------------------------------------------------------------------------------------
| epoch   1 step    11800 |  11800 batches | lr 0.0001 | ms/batch 72.23 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 236 at step    11800 | time:  3.61s | valid loss 14.36 | valid ppl 1725089.300
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 237 at step    11850 | time:  3.68s | valid loss 14.50 | valid ppl 1973286.361
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 238 at step    11900 | time:  3.64s | valid loss 14.34 | valid ppl 1690150.700
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 239 at step    11950 | time:  3.64s | valid loss 14.43 | valid ppl 1851272.363
----------------------------------------------------------------------------------------------------
| epoch   1 step    12000 |  12000 batches | lr 0.0001 | ms/batch 72.99 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 240 at step    12000 | time:  3.64s | valid loss 14.57 | valid ppl 2118212.006
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 241 at step    12050 | time:  3.67s | valid loss 14.40 | valid ppl 1799931.390
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 242 at step    12100 | time:  3.68s | valid loss 14.50 | valid ppl 1977453.156
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 243 at step    12150 | time:  3.68s | valid loss 14.63 | valid ppl 2265773.937
----------------------------------------------------------------------------------------------------
| epoch   1 step    12200 |  12200 batches | lr 0.0001 | ms/batch 73.59 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 244 at step    12200 | time:  3.69s | valid loss 14.48 | valid ppl 1936750.527
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 245 at step    12250 | time:  3.68s | valid loss 14.57 | valid ppl 2122270.481
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 246 at step    12300 | time:  3.75s | valid loss 14.70 | valid ppl 2431569.169
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 247 at step    12350 | time:  3.66s | valid loss 14.54 | valid ppl 2070424.975
----------------------------------------------------------------------------------------------------
| epoch   1 step    12400 |  12400 batches | lr 0.0001 | ms/batch 73.75 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 248 at step    12400 | time:  3.65s | valid loss 14.64 | valid ppl 2275240.157
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 249 at step    12450 | time:  3.68s | valid loss 14.77 | valid ppl 2605803.644
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 250 at step    12500 | time:  3.67s | valid loss 14.61 | valid ppl 2218308.688
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 251 at step    12550 | time:  3.65s | valid loss 14.70 | valid ppl 2431918.610
----------------------------------------------------------------------------------------------------
| epoch   1 step    12600 |  12600 batches | lr 0.0001 | ms/batch 73.37 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 252 at step    12600 | time:  3.68s | valid loss 14.84 | valid ppl 2783929.481
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 253 at step    12650 | time:  3.71s | valid loss 14.68 | valid ppl 2371195.508
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 254 at step    12700 | time:  3.78s | valid loss 14.77 | valid ppl 2608327.329
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 255 at step    12750 | time:  3.66s | valid loss 14.91 | valid ppl 2996147.196
----------------------------------------------------------------------------------------------------
| epoch   1 step    12800 |  12800 batches | lr 0.0001 | ms/batch 74.35 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 256 at step    12800 | time:  3.73s | valid loss 14.75 | valid ppl 2543433.693
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 257 at step    12850 | time:  3.74s | valid loss 14.84 | valid ppl 2782065.525
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 258 at step    12900 | time:  3.73s | valid loss 14.98 | valid ppl 3191414.789
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 259 at step    12950 | time:  3.70s | valid loss 14.82 | valid ppl 2732746.849
----------------------------------------------------------------------------------------------------
| epoch   1 step    13000 |  13000 batches | lr 0.0001 | ms/batch 74.78 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 260 at step    13000 | time:  3.77s | valid loss 14.91 | valid ppl 2984302.047
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 261 at step    13050 | time:  3.74s | valid loss 15.05 | valid ppl 3446705.881
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 262 at step    13100 | time:  3.84s | valid loss 14.89 | valid ppl 2923430.737
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 263 at step    13150 | time:  3.77s | valid loss 14.98 | valid ppl 3197993.847
----------------------------------------------------------------------------------------------------
| epoch   1 step    13200 |  13200 batches | lr 0.0001 | ms/batch 75.67 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 264 at step    13200 | time:  3.79s | valid loss 15.12 | valid ppl 3690124.057
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 265 at step    13250 | time:  3.82s | valid loss 14.96 | valid ppl 3125813.883
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 266 at step    13300 | time:  3.78s | valid loss 15.05 | valid ppl 3431216.257
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 267 at step    13350 | time:  3.79s | valid loss 15.19 | valid ppl 3959715.961
----------------------------------------------------------------------------------------------------
| epoch   1 step    13400 |  13400 batches | lr 0.0001 | ms/batch 75.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 268 at step    13400 | time:  3.80s | valid loss 15.03 | valid ppl 3361613.399
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 269 at step    13450 | time:  3.77s | valid loss 15.12 | valid ppl 3680368.656
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 270 at step    13500 | time:  3.86s | valid loss 15.26 | valid ppl 4249434.716
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 271 at step    13550 | time:  3.76s | valid loss 15.10 | valid ppl 3594895.643
----------------------------------------------------------------------------------------------------
| epoch   1 step    13600 |  13600 batches | lr 0.0001 | ms/batch 75.99 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 272 at step    13600 | time:  3.78s | valid loss 15.19 | valid ppl 3949986.041
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 273 at step    13650 | time:  3.82s | valid loss 15.33 | valid ppl 4551234.882
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 274 at step    13700 | time:  3.82s | valid loss 15.17 | valid ppl 3862267.643
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 275 at step    13750 | time:  3.82s | valid loss 15.26 | valid ppl 4236589.750
----------------------------------------------------------------------------------------------------
| epoch   1 step    13800 |  13800 batches | lr 0.0001 | ms/batch 76.50 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 276 at step    13800 | time:  3.85s | valid loss 15.40 | valid ppl 4879312.044
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 277 at step    13850 | time:  3.83s | valid loss 15.24 | valid ppl 4136435.095
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 278 at step    13900 | time:  3.87s | valid loss 15.33 | valid ppl 4549615.508
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 279 at step    13950 | time:  3.78s | valid loss 15.47 | valid ppl 5253925.175
----------------------------------------------------------------------------------------------------
| epoch   1 step    14000 |  14000 batches | lr 0.0001 | ms/batch 76.82 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 280 at step    14000 | time:  3.84s | valid loss 15.30 | valid ppl 4414785.888
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 281 at step    14050 | time:  3.82s | valid loss 15.40 | valid ppl 4856111.429
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 282 at step    14100 | time:  3.82s | valid loss 15.54 | valid ppl 5614017.585
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 283 at step    14150 | time:  3.88s | valid loss 15.37 | valid ppl 4741188.139
----------------------------------------------------------------------------------------------------
| epoch   1 step    14200 |  14200 batches | lr 0.0001 | ms/batch 76.93 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 284 at step    14200 | time:  3.88s | valid loss 15.47 | valid ppl 5206237.306
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 285 at step    14250 | time:  3.83s | valid loss 15.61 | valid ppl 6011099.029
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 286 at step    14300 | time:  3.94s | valid loss 15.44 | valid ppl 5085397.787
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 287 at step    14350 | time:  3.87s | valid loss 15.53 | valid ppl 5581046.150
----------------------------------------------------------------------------------------------------
| epoch   1 step    14400 |  14400 batches | lr 0.0001 | ms/batch 77.65 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 288 at step    14400 | time:  3.86s | valid loss 15.68 | valid ppl 6463822.226
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 289 at step    14450 | time:  3.88s | valid loss 15.51 | valid ppl 5452222.128
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 290 at step    14500 | time:  3.87s | valid loss 15.61 | valid ppl 6001087.195
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 291 at step    14550 | time:  3.88s | valid loss 15.75 | valid ppl 6943359.938
----------------------------------------------------------------------------------------------------
| epoch   1 step    14600 |  14600 batches | lr 0.0001 | ms/batch 77.52 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 292 at step    14600 | time:  3.90s | valid loss 15.58 | valid ppl 5860328.405
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 293 at step    14650 | time:  3.90s | valid loss 15.68 | valid ppl 6433660.963
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 294 at step    14700 | time:  3.98s | valid loss 15.82 | valid ppl 7452696.105
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 295 at step    14750 | time:  3.91s | valid loss 15.65 | valid ppl 6281750.830
----------------------------------------------------------------------------------------------------
| epoch   1 step    14800 |  14800 batches | lr 0.0001 | ms/batch 78.59 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 296 at step    14800 | time:  3.90s | valid loss 15.75 | valid ppl 6886422.746
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 297 at step    14850 | time:  3.90s | valid loss 15.89 | valid ppl 7988276.932
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 298 at step    14900 | time:  3.84s | valid loss 15.72 | valid ppl 6731106.358
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 299 at step    14950 | time:  3.94s | valid loss 15.82 | valid ppl 7393453.744
----------------------------------------------------------------------------------------------------
| epoch   1 step    15000 |  15000 batches | lr 0.0001 | ms/batch 77.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 300 at step    15000 | time:  3.89s | valid loss 15.96 | valid ppl 8567217.837
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 301 at step    15050 | time:  3.97s | valid loss 15.79 | valid ppl 7212840.689
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 302 at step    15100 | time:  3.95s | valid loss 15.89 | valid ppl 7927559.940
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 303 at step    15150 | time:  3.92s | valid loss 16.03 | valid ppl 9195959.048
----------------------------------------------------------------------------------------------------
| epoch   1 step    15200 |  15200 batches | lr 0.0001 | ms/batch 78.75 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 304 at step    15200 | time:  3.93s | valid loss 15.86 | valid ppl 7721079.623
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 305 at step    15250 | time:  3.96s | valid loss 15.95 | valid ppl 8478276.709
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 306 at step    15300 | time:  3.95s | valid loss 16.10 | valid ppl 9834124.810
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 307 at step    15350 | time:  3.98s | valid loss 15.93 | valid ppl 8246733.179
----------------------------------------------------------------------------------------------------
| epoch   1 step    15400 |  15400 batches | lr 0.0001 | ms/batch 79.42 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 308 at step    15400 | time:  3.98s | valid loss 16.02 | valid ppl 9073718.149
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 309 at step    15450 | time:  4.05s | valid loss 16.17 | valid ppl 10529028.763
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 310 at step    15500 | time:  3.92s | valid loss 16.00 | valid ppl 8847134.940
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 311 at step    15550 | time:  4.01s | valid loss 16.09 | valid ppl 9713098.573
----------------------------------------------------------------------------------------------------
| epoch   1 step    15600 |  15600 batches | lr 0.0001 | ms/batch 79.88 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 312 at step    15600 | time:  4.01s | valid loss 16.24 | valid ppl 11299957.522
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 313 at step    15650 | time:  4.00s | valid loss 16.06 | valid ppl 9481714.003
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 314 at step    15700 | time:  3.99s | valid loss 16.16 | valid ppl 10404293.848
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 315 at step    15750 | time:  3.99s | valid loss 16.31 | valid ppl 12076259.425
----------------------------------------------------------------------------------------------------
| epoch   1 step    15800 |  15800 batches | lr 0.0001 | ms/batch 79.95 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 316 at step    15800 | time:  4.02s | valid loss 16.13 | valid ppl 10145123.262
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 317 at step    15850 | time:  4.00s | valid loss 16.22 | valid ppl 11123262.970
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 318 at step    15900 | time:  4.00s | valid loss 16.38 | valid ppl 12954341.831
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 319 at step    15950 | time:  3.99s | valid loss 16.20 | valid ppl 10866075.959
----------------------------------------------------------------------------------------------------
| epoch   1 step    16000 |  16000 batches | lr 0.0001 | ms/batch 80.18 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 320 at step    16000 | time:  3.78s | valid loss 16.29 | valid ppl 11916076.464
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 321 at step    16050 | time:  3.99s | valid loss 16.45 | valid ppl 13890263.495
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 322 at step    16100 | time:  4.01s | valid loss 16.27 | valid ppl 11626488.886
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 323 at step    16150 | time:  3.99s | valid loss 16.36 | valid ppl 12747464.572
----------------------------------------------------------------------------------------------------
| epoch   1 step    16200 |  16200 batches | lr 0.0001 | ms/batch 79.30 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 324 at step    16200 | time:  4.06s | valid loss 16.51 | valid ppl 14852882.181
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 325 at step    16250 | time:  3.96s | valid loss 16.33 | valid ppl 12414582.682
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 326 at step    16300 | time:  3.96s | valid loss 16.43 | valid ppl 13655452.733
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 327 at step    16350 | time:  3.98s | valid loss 16.58 | valid ppl 15912999.983
----------------------------------------------------------------------------------------------------
| epoch   1 step    16400 |  16400 batches | lr 0.0001 | ms/batch 79.80 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 328 at step    16400 | time:  4.06s | valid loss 16.41 | valid ppl 13328738.914
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 329 at step    16450 | time:  4.01s | valid loss 16.50 | valid ppl 14604152.770
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 330 at step    16500 | time:  4.01s | valid loss 16.65 | valid ppl 17041351.229
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 331 at step    16550 | time:  4.07s | valid loss 16.47 | valid ppl 14236947.363
----------------------------------------------------------------------------------------------------
| epoch   1 step    16600 |  16600 batches | lr 0.0001 | ms/batch 81.06 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 332 at step    16600 | time:  4.11s | valid loss 16.56 | valid ppl 15601878.449
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 333 at step    16650 | time:  4.05s | valid loss 16.72 | valid ppl 18193244.427
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 334 at step    16700 | time:  3.98s | valid loss 16.54 | valid ppl 15216122.807
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 335 at step    16750 | time:  3.95s | valid loss 16.63 | valid ppl 16691988.857
----------------------------------------------------------------------------------------------------
| epoch   1 step    16800 |  16800 batches | lr 0.0001 | ms/batch 80.09 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 336 at step    16800 | time:  4.09s | valid loss 16.79 | valid ppl 19484412.618
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 337 at step    16850 | time:  4.11s | valid loss 16.60 | valid ppl 16267831.430
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 338 at step    16900 | time:  4.09s | valid loss 16.70 | valid ppl 17856515.082
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
