Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : mixed
    - n_layer : 2
    - n_head : 6
    - d_head : 128
    - d_embed : 128
    - d_model : 128
    - d_inner : 64
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 128
    - batch_chunk : 1
    - tgt_len : 32
    - eval_tgt_len : 32
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 50
    - work_dir : LM-TFM-mixed/20230514-134358
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 1
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - tied : True
    - n_token : 256
    - n_all_param : 904704
    - n_nonemb_param : 820608
====================================================================================================
#params = 904704
#non emb params = 820608
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step       50 | time:  3.04s | valid loss  5.15 | valid ppl   171.949
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      100 | time:  2.37s | valid loss  5.93 | valid ppl   374.509
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      150 | time:  2.40s | valid loss  6.94 | valid ppl  1031.117
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 49.50 | loss  0.32 | ppl     1.377
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      200 | time:  2.41s | valid loss  8.10 | valid ppl  3283.231
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      250 | time:  2.39s | valid loss  9.06 | valid ppl  8637.250
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      300 | time:  2.40s | valid loss  9.60 | valid ppl 14744.720
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      350 | time:  2.41s | valid loss 10.03 | valid ppl 22803.962
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 48.16 | loss  0.02 | ppl     1.021
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      400 | time:  2.41s | valid loss 10.25 | valid ppl 28401.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      450 | time:  2.41s | valid loss 10.41 | valid ppl 33151.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step      500 | time:  2.42s | valid loss 10.64 | valid ppl 41876.780
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step      550 | time:  2.41s | valid loss 10.74 | valid ppl 46291.201
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 48.36 | loss  0.01 | ppl     1.005
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step      600 | time:  2.42s | valid loss 10.80 | valid ppl 49230.159
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step      650 | time:  2.50s | valid loss 10.97 | valid ppl 57818.188
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step      700 | time:  2.43s | valid loss 11.03 | valid ppl 61795.757
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step      750 | time:  2.42s | valid loss 11.06 | valid ppl 63374.127
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 49.17 | loss  0.00 | ppl     1.003
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step      800 | time:  2.46s | valid loss 11.17 | valid ppl 71215.648
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step      850 | time:  2.43s | valid loss 11.20 | valid ppl 73482.837
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step      900 | time:  2.45s | valid loss 11.20 | valid ppl 73147.195
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step      950 | time:  2.44s | valid loss 11.27 | valid ppl 78674.222
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 48.90 | loss  0.00 | ppl     1.002
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     1000 | time:  2.45s | valid loss 11.31 | valid ppl 81724.141
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     1050 | time:  2.46s | valid loss 11.27 | valid ppl 78502.277
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     1100 | time:  2.43s | valid loss 11.33 | valid ppl 83654.249
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     1150 | time:  2.44s | valid loss 11.35 | valid ppl 84586.785
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 49.14 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     1200 | time:  2.50s | valid loss 11.31 | valid ppl 81590.748
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     1250 | time:  2.56s | valid loss 11.35 | valid ppl 85033.492
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     1300 | time:  2.48s | valid loss 11.34 | valid ppl 84449.464
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     1350 | time:  2.46s | valid loss 11.29 | valid ppl 79994.747
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 50.01 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     1400 | time:  2.47s | valid loss 11.29 | valid ppl 80332.957
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     1450 | time:  2.47s | valid loss 11.29 | valid ppl 80395.943
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     1500 | time:  2.48s | valid loss 11.22 | valid ppl 74901.739
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     1550 | time:  2.47s | valid loss 11.22 | valid ppl 74268.742
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 49.45 | loss  0.00 | ppl     1.001
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     1600 | time:  2.47s | valid loss 11.20 | valid ppl 73202.671
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     1650 | time:  2.47s | valid loss 11.14 | valid ppl 68712.614
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     1700 | time:  2.50s | valid loss 11.13 | valid ppl 68102.339
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     1750 | time:  2.47s | valid loss 11.13 | valid ppl 67912.701
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 49.56 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     1800 | time:  2.47s | valid loss 11.07 | valid ppl 63904.542
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     1850 | time:  2.60s | valid loss 11.05 | valid ppl 62896.679
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     1900 | time:  2.49s | valid loss 11.07 | valid ppl 64373.338
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     1950 | time:  2.51s | valid loss 11.03 | valid ppl 61841.297
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 50.68 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     2000 | time:  2.52s | valid loss 11.02 | valid ppl 61314.273
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     2050 | time:  2.49s | valid loss 11.06 | valid ppl 63509.588
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     2100 | time:  2.46s | valid loss 11.04 | valid ppl 62616.039
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     2150 | time:  2.49s | valid loss 11.03 | valid ppl 61702.206
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 49.69 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     2200 | time:  2.48s | valid loss 11.08 | valid ppl 65081.873
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     2250 | time:  2.51s | valid loss 11.09 | valid ppl 65263.811
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     2300 | time:  2.52s | valid loss 11.08 | valid ppl 64859.249
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  47 at step     2350 | time:  2.54s | valid loss 11.14 | valid ppl 68897.256
----------------------------------------------------------------------------------------------------
| epoch   1 step     2400 |   2400 batches | lr 0.0001 | ms/batch 50.31 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  48 at step     2400 | time:  2.49s | valid loss 11.16 | valid ppl 70380.752
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  49 at step     2450 | time:  2.62s | valid loss 11.15 | valid ppl 69810.817
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  50 at step     2500 | time:  2.52s | valid loss 11.22 | valid ppl 74241.688
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  51 at step     2550 | time:  2.54s | valid loss 11.25 | valid ppl 76580.132
----------------------------------------------------------------------------------------------------
| epoch   1 step     2600 |   2600 batches | lr 0.0001 | ms/batch 51.00 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  52 at step     2600 | time:  2.54s | valid loss 11.24 | valid ppl 76338.532
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  53 at step     2650 | time:  2.53s | valid loss 11.31 | valid ppl 81810.423
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  54 at step     2700 | time:  2.56s | valid loss 11.35 | valid ppl 85324.958
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  55 at step     2750 | time:  2.52s | valid loss 11.34 | valid ppl 84044.404
----------------------------------------------------------------------------------------------------
| epoch   1 step     2800 |   2800 batches | lr 0.0001 | ms/batch 50.82 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  56 at step     2800 | time:  2.53s | valid loss 11.41 | valid ppl 89918.930
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  57 at step     2850 | time:  2.53s | valid loss 11.45 | valid ppl 93583.702
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  58 at step     2900 | time:  2.54s | valid loss 11.43 | valid ppl 92064.254
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  59 at step     2950 | time:  2.53s | valid loss 11.49 | valid ppl 97924.527
----------------------------------------------------------------------------------------------------
| epoch   1 step     3000 |   3000 batches | lr 0.0001 | ms/batch 50.89 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  60 at step     3000 | time:  2.55s | valid loss 11.54 | valid ppl 103070.750
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  61 at step     3050 | time:  2.65s | valid loss 11.52 | valid ppl 101003.191
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  62 at step     3100 | time:  2.54s | valid loss 11.58 | valid ppl 107433.555
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  63 at step     3150 | time:  2.55s | valid loss 11.63 | valid ppl 112905.119
----------------------------------------------------------------------------------------------------
| epoch   1 step     3200 |   3200 batches | lr 0.0001 | ms/batch 51.50 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  64 at step     3200 | time:  2.57s | valid loss 11.61 | valid ppl 109723.345
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  65 at step     3250 | time:  2.51s | valid loss 11.67 | valid ppl 117207.983
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  66 at step     3300 | time:  2.54s | valid loss 11.72 | valid ppl 122458.395
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  67 at step     3350 | time:  2.55s | valid loss 11.68 | valid ppl 118596.918
----------------------------------------------------------------------------------------------------
| epoch   1 step     3400 |   3400 batches | lr 0.0001 | ms/batch 50.97 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  68 at step     3400 | time:  2.55s | valid loss 11.74 | valid ppl 125768.515
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  69 at step     3450 | time:  2.57s | valid loss 11.79 | valid ppl 131872.710
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  70 at step     3500 | time:  2.60s | valid loss 11.75 | valid ppl 126756.615
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  71 at step     3550 | time:  2.59s | valid loss 11.81 | valid ppl 134258.778
----------------------------------------------------------------------------------------------------
| epoch   1 step     3600 |   3600 batches | lr 0.0001 | ms/batch 51.80 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  72 at step     3600 | time:  2.57s | valid loss 11.85 | valid ppl 140344.195
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  73 at step     3650 | time:  2.63s | valid loss 11.81 | valid ppl 134292.905
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  74 at step     3700 | time:  2.56s | valid loss 11.87 | valid ppl 142208.614
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  75 at step     3750 | time:  2.60s | valid loss 11.91 | valid ppl 148607.553
----------------------------------------------------------------------------------------------------
| epoch   1 step     3800 |   3800 batches | lr 0.0001 | ms/batch 51.93 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  76 at step     3800 | time:  2.63s | valid loss 11.87 | valid ppl 142237.670
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  77 at step     3850 | time:  2.60s | valid loss 11.92 | valid ppl 150293.136
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  78 at step     3900 | time:  2.63s | valid loss 11.97 | valid ppl 157182.500
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  79 at step     3950 | time:  2.63s | valid loss 11.91 | valid ppl 149487.702
----------------------------------------------------------------------------------------------------
| epoch   1 step     4000 |   4000 batches | lr 0.0001 | ms/batch 52.35 | loss  0.00 | ppl     1.000
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  80 at step     4000 | time:  2.61s | valid loss 11.96 | valid ppl 156896.079
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  81 at step     4050 | time:  2.65s | valid loss 12.01 | valid ppl 165179.641
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  82 at step     4100 | time:  2.63s | valid loss 11.96 | valid ppl 156494.553
----------------------------------------------------------------------------------------------------
