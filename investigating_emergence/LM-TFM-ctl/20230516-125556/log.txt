Data set loaded
====================================================================================================
    - data : data/mixed/
    - dataset : ctl
    - n_layer : 6
    - n_head : 6
    - d_head : 128
    - d_embed : 128
    - d_model : 128
    - d_inner : 256
    - dropout : 0.1
    - dropatt : 0.0
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : adam
    - lr : 0.0001
    - mom : 0.0
    - scheduler : constant
    - warmup_step : 0
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - clip_nonemb : False
    - max_step : 10000000
    - batch_size : 1
    - batch_chunk : 1
    - tgt_len : 128
    - eval_tgt_len : 128
    - ext_len : 0
    - mem_len : 0
    - not_tied : False
    - seed : 1111
    - cuda : True
    - adaptive : False
    - div_val : 1
    - pre_lnorm : False
    - varlen : False
    - multi_gpu : False
    - log_interval : 200
    - eval_interval : 50
    - work_dir : LM-TFM-ctl/20230516-125556
    - restart : False
    - restart_dir : 
    - debug : False
    - same_length : False
    - attn_type : 0
    - clamp_len : -1
    - eta_min : 0.0
    - gpu0_bsz : -1
    - max_eval_steps : -1
    - sample_softmax : -1
    - patience : 0
    - finetune_v2 : False
    - finetune_v3 : False
    - fp16 : False
    - static_loss_scale : 1
    - dynamic_loss_scale : False
    - mixing_rate : 1.0
    - tied : True
    - n_token : 256
    - n_all_param : 3382272
    - n_nonemb_param : 3347712
====================================================================================================
#params = 3382272
#non emb params = 3347712
Start training
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   1 at step       50 | time:  5.51s | valid loss  3.74 | valid ppl    42.254
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   2 at step      100 | time:  2.87s | valid loss  2.63 | valid ppl    13.840
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   3 at step      150 | time:  2.85s | valid loss  1.85 | valid ppl     6.341
----------------------------------------------------------------------------------------------------
| epoch   1 step      200 |    200 batches | lr 0.0001 | ms/batch 72.54 | loss  2.86 | ppl    17.503
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   4 at step      200 | time:  2.92s | valid loss  1.36 | valid ppl     3.914
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   5 at step      250 | time:  2.78s | valid loss  0.97 | valid ppl     2.636
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   6 at step      300 | time:  2.91s | valid loss  0.83 | valid ppl     2.295
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   7 at step      350 | time:  2.78s | valid loss  0.73 | valid ppl     2.075
----------------------------------------------------------------------------------------------------
| epoch   1 step      400 |    400 batches | lr 0.0001 | ms/batch 61.91 | loss  0.89 | ppl     2.446
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   8 at step      400 | time:  2.95s | valid loss  0.62 | valid ppl     1.861
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval   9 at step      450 | time:  2.86s | valid loss  0.57 | valid ppl     1.765
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  10 at step      500 | time:  2.98s | valid loss  0.54 | valid ppl     1.712
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  11 at step      550 | time:  2.78s | valid loss  0.48 | valid ppl     1.622
----------------------------------------------------------------------------------------------------
| epoch   1 step      600 |    600 batches | lr 0.0001 | ms/batch 61.85 | loss  0.56 | ppl     1.744
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  12 at step      600 | time:  2.87s | valid loss  0.48 | valid ppl     1.624
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  13 at step      650 | time:  2.77s | valid loss  0.49 | valid ppl     1.630
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  14 at step      700 | time:  2.93s | valid loss  0.42 | valid ppl     1.523
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  15 at step      750 | time:  2.78s | valid loss  0.47 | valid ppl     1.593
----------------------------------------------------------------------------------------------------
| epoch   1 step      800 |    800 batches | lr 0.0001 | ms/batch 58.10 | loss  0.48 | ppl     1.623
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  16 at step      800 | time:  2.91s | valid loss  0.47 | valid ppl     1.595
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  17 at step      850 | time:  2.80s | valid loss  0.49 | valid ppl     1.636
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  18 at step      900 | time:  2.89s | valid loss  0.44 | valid ppl     1.556
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  19 at step      950 | time:  2.95s | valid loss  0.40 | valid ppl     1.498
----------------------------------------------------------------------------------------------------
| epoch   1 step     1000 |   1000 batches | lr 0.0001 | ms/batch 58.92 | loss  0.45 | ppl     1.570
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  20 at step     1000 | time:  2.89s | valid loss  0.49 | valid ppl     1.632
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  21 at step     1050 | time:  3.02s | valid loss  0.41 | valid ppl     1.509
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  22 at step     1100 | time:  3.06s | valid loss  0.53 | valid ppl     1.704
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  23 at step     1150 | time:  2.96s | valid loss  0.47 | valid ppl     1.598
----------------------------------------------------------------------------------------------------
| epoch   1 step     1200 |   1200 batches | lr 0.0001 | ms/batch 60.19 | loss  0.44 | ppl     1.551
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  24 at step     1200 | time:  2.88s | valid loss  0.38 | valid ppl     1.468
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  25 at step     1250 | time:  2.93s | valid loss  0.43 | valid ppl     1.532
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  26 at step     1300 | time:  2.80s | valid loss  0.36 | valid ppl     1.435
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  27 at step     1350 | time:  2.90s | valid loss  0.41 | valid ppl     1.512
----------------------------------------------------------------------------------------------------
| epoch   1 step     1400 |   1400 batches | lr 0.0001 | ms/batch 59.76 | loss  0.43 | ppl     1.532
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  28 at step     1400 | time:  2.83s | valid loss  0.45 | valid ppl     1.561
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  29 at step     1450 | time:  3.01s | valid loss  0.38 | valid ppl     1.466
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  30 at step     1500 | time:  2.85s | valid loss  0.43 | valid ppl     1.542
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  31 at step     1550 | time:  2.90s | valid loss  0.42 | valid ppl     1.516
----------------------------------------------------------------------------------------------------
| epoch   1 step     1600 |   1600 batches | lr 0.0001 | ms/batch 58.53 | loss  0.41 | ppl     1.513
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  32 at step     1600 | time:  2.87s | valid loss  0.40 | valid ppl     1.497
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  33 at step     1650 | time:  2.87s | valid loss  0.45 | valid ppl     1.564
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  34 at step     1700 | time:  2.86s | valid loss  0.43 | valid ppl     1.541
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  35 at step     1750 | time:  2.86s | valid loss  0.42 | valid ppl     1.528
----------------------------------------------------------------------------------------------------
| epoch   1 step     1800 |   1800 batches | lr 0.0001 | ms/batch 57.76 | loss  0.41 | ppl     1.508
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  36 at step     1800 | time:  2.89s | valid loss  0.38 | valid ppl     1.466
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  37 at step     1850 | time:  2.81s | valid loss  0.40 | valid ppl     1.496
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  38 at step     1900 | time:  2.91s | valid loss  0.41 | valid ppl     1.501
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  39 at step     1950 | time:  2.81s | valid loss  0.44 | valid ppl     1.555
----------------------------------------------------------------------------------------------------
| epoch   1 step     2000 |   2000 batches | lr 0.0001 | ms/batch 58.12 | loss  0.42 | ppl     1.516
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  40 at step     2000 | time:  3.07s | valid loss  0.40 | valid ppl     1.494
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  41 at step     2050 | time:  2.81s | valid loss  0.36 | valid ppl     1.438
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  42 at step     2100 | time:  2.89s | valid loss  0.43 | valid ppl     1.530
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  43 at step     2150 | time:  2.80s | valid loss  0.47 | valid ppl     1.594
----------------------------------------------------------------------------------------------------
| epoch   1 step     2200 |   2200 batches | lr 0.0001 | ms/batch 57.05 | loss  0.41 | ppl     1.507
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  44 at step     2200 | time:  2.86s | valid loss  0.46 | valid ppl     1.583
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  45 at step     2250 | time:  2.85s | valid loss  0.43 | valid ppl     1.533
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  46 at step     2300 | time:  2.87s | valid loss  0.43 | valid ppl     1.532
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  47 at step     2350 | time:  2.86s | valid loss  0.41 | valid ppl     1.505
----------------------------------------------------------------------------------------------------
| epoch   1 step     2400 |   2400 batches | lr 0.0001 | ms/batch 57.34 | loss  0.42 | ppl     1.521
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  48 at step     2400 | time:  2.78s | valid loss  0.44 | valid ppl     1.548
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  49 at step     2450 | time:  2.91s | valid loss  0.40 | valid ppl     1.486
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  50 at step     2500 | time:  2.83s | valid loss  0.50 | valid ppl     1.645
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  51 at step     2550 | time:  3.01s | valid loss  0.37 | valid ppl     1.454
----------------------------------------------------------------------------------------------------
| epoch   1 step     2600 |   2600 batches | lr 0.0001 | ms/batch 58.03 | loss  0.40 | ppl     1.497
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  52 at step     2600 | time:  2.79s | valid loss  0.41 | valid ppl     1.512
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  53 at step     2650 | time:  2.86s | valid loss  0.38 | valid ppl     1.468
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  54 at step     2700 | time:  2.80s | valid loss  0.45 | valid ppl     1.561
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  55 at step     2750 | time:  2.86s | valid loss  0.41 | valid ppl     1.507
----------------------------------------------------------------------------------------------------
| epoch   1 step     2800 |   2800 batches | lr 0.0001 | ms/batch 57.31 | loss  0.41 | ppl     1.505
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  56 at step     2800 | time:  2.87s | valid loss  0.42 | valid ppl     1.522
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  57 at step     2850 | time:  2.81s | valid loss  0.38 | valid ppl     1.461
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  58 at step     2900 | time:  2.88s | valid loss  0.39 | valid ppl     1.477
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  59 at step     2950 | time:  2.80s | valid loss  0.35 | valid ppl     1.423
----------------------------------------------------------------------------------------------------
| epoch   1 step     3000 |   3000 batches | lr 0.0001 | ms/batch 58.24 | loss  0.41 | ppl     1.506
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  60 at step     3000 | time:  2.91s | valid loss  0.47 | valid ppl     1.606
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  61 at step     3050 | time:  2.92s | valid loss  0.49 | valid ppl     1.630
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  62 at step     3100 | time:  2.88s | valid loss  0.37 | valid ppl     1.449
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  63 at step     3150 | time:  2.83s | valid loss  0.37 | valid ppl     1.444
----------------------------------------------------------------------------------------------------
| epoch   1 step     3200 |   3200 batches | lr 0.0001 | ms/batch 57.87 | loss  0.41 | ppl     1.503
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  64 at step     3200 | time:  2.90s | valid loss  0.38 | valid ppl     1.466
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  65 at step     3250 | time:  2.81s | valid loss  0.39 | valid ppl     1.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  66 at step     3300 | time:  2.89s | valid loss  0.43 | valid ppl     1.533
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  67 at step     3350 | time:  2.85s | valid loss  0.37 | valid ppl     1.448
----------------------------------------------------------------------------------------------------
| epoch   1 step     3400 |   3400 batches | lr 0.0001 | ms/batch 57.37 | loss  0.40 | ppl     1.494
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  68 at step     3400 | time:  2.87s | valid loss  0.35 | valid ppl     1.426
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  69 at step     3450 | time:  2.84s | valid loss  0.46 | valid ppl     1.582
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  70 at step     3500 | time:  2.82s | valid loss  0.40 | valid ppl     1.498
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  71 at step     3550 | time:  2.92s | valid loss  0.34 | valid ppl     1.411
----------------------------------------------------------------------------------------------------
| epoch   1 step     3600 |   3600 batches | lr 0.0001 | ms/batch 59.22 | loss  0.40 | ppl     1.497
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  72 at step     3600 | time:  2.95s | valid loss  0.44 | valid ppl     1.547
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  73 at step     3650 | time:  2.89s | valid loss  0.38 | valid ppl     1.469
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  74 at step     3700 | time:  2.80s | valid loss  0.40 | valid ppl     1.497
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  75 at step     3750 | time:  2.90s | valid loss  0.45 | valid ppl     1.573
----------------------------------------------------------------------------------------------------
| epoch   1 step     3800 |   3800 batches | lr 0.0001 | ms/batch 57.40 | loss  0.41 | ppl     1.508
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  76 at step     3800 | time:  2.85s | valid loss  0.39 | valid ppl     1.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  77 at step     3850 | time:  2.90s | valid loss  0.40 | valid ppl     1.490
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  78 at step     3900 | time:  2.83s | valid loss  0.45 | valid ppl     1.570
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  79 at step     3950 | time:  2.85s | valid loss  0.46 | valid ppl     1.589
----------------------------------------------------------------------------------------------------
| epoch   1 step     4000 |   4000 batches | lr 0.0001 | ms/batch 57.61 | loss  0.41 | ppl     1.503
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  80 at step     4000 | time:  2.86s | valid loss  0.34 | valid ppl     1.405
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  81 at step     4050 | time:  2.90s | valid loss  0.45 | valid ppl     1.569
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  82 at step     4100 | time:  2.97s | valid loss  0.43 | valid ppl     1.536
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  83 at step     4150 | time:  2.80s | valid loss  0.37 | valid ppl     1.454
----------------------------------------------------------------------------------------------------
| epoch   1 step     4200 |   4200 batches | lr 0.0001 | ms/batch 59.27 | loss  0.41 | ppl     1.501
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  84 at step     4200 | time:  2.89s | valid loss  0.39 | valid ppl     1.474
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  85 at step     4250 | time:  2.81s | valid loss  0.46 | valid ppl     1.581
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  86 at step     4300 | time:  2.93s | valid loss  0.47 | valid ppl     1.595
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  87 at step     4350 | time:  2.81s | valid loss  0.49 | valid ppl     1.626
----------------------------------------------------------------------------------------------------
| epoch   1 step     4400 |   4400 batches | lr 0.0001 | ms/batch 57.50 | loss  0.40 | ppl     1.495
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  88 at step     4400 | time:  2.92s | valid loss  0.46 | valid ppl     1.587
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  89 at step     4450 | time:  2.77s | valid loss  0.38 | valid ppl     1.459
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  90 at step     4500 | time:  2.91s | valid loss  0.41 | valid ppl     1.512
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  91 at step     4550 | time:  2.84s | valid loss  0.40 | valid ppl     1.487
----------------------------------------------------------------------------------------------------
| epoch   1 step     4600 |   4600 batches | lr 0.0001 | ms/batch 57.26 | loss  0.42 | ppl     1.518
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  92 at step     4600 | time:  2.87s | valid loss  0.42 | valid ppl     1.523
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  93 at step     4650 | time:  2.95s | valid loss  0.41 | valid ppl     1.514
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  94 at step     4700 | time:  2.81s | valid loss  0.41 | valid ppl     1.504
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  95 at step     4750 | time:  2.91s | valid loss  0.41 | valid ppl     1.501
----------------------------------------------------------------------------------------------------
| epoch   1 step     4800 |   4800 batches | lr 0.0001 | ms/batch 57.94 | loss  0.40 | ppl     1.494
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  96 at step     4800 | time:  2.80s | valid loss  0.41 | valid ppl     1.503
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  97 at step     4850 | time:  2.92s | valid loss  0.43 | valid ppl     1.537
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  98 at step     4900 | time:  2.79s | valid loss  0.37 | valid ppl     1.450
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval  99 at step     4950 | time:  2.92s | valid loss  0.39 | valid ppl     1.481
----------------------------------------------------------------------------------------------------
| epoch   1 step     5000 |   5000 batches | lr 0.0001 | ms/batch 57.53 | loss  0.40 | ppl     1.491
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 100 at step     5000 | time:  2.81s | valid loss  0.36 | valid ppl     1.429
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 101 at step     5050 | time:  2.86s | valid loss  0.36 | valid ppl     1.432
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 102 at step     5100 | time:  2.87s | valid loss  0.42 | valid ppl     1.527
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 103 at step     5150 | time:  2.92s | valid loss  0.44 | valid ppl     1.549
----------------------------------------------------------------------------------------------------
| epoch   1 step     5200 |   5200 batches | lr 0.0001 | ms/batch 58.00 | loss  0.40 | ppl     1.498
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 104 at step     5200 | time:  2.88s | valid loss  0.37 | valid ppl     1.454
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 105 at step     5250 | time:  2.80s | valid loss  0.43 | valid ppl     1.533
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 106 at step     5300 | time:  2.90s | valid loss  0.36 | valid ppl     1.430
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 107 at step     5350 | time:  2.80s | valid loss  0.42 | valid ppl     1.528
----------------------------------------------------------------------------------------------------
| epoch   1 step     5400 |   5400 batches | lr 0.0001 | ms/batch 57.31 | loss  0.41 | ppl     1.500
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 108 at step     5400 | time:  2.93s | valid loss  0.39 | valid ppl     1.475
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 109 at step     5450 | time:  2.80s | valid loss  0.45 | valid ppl     1.567
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 110 at step     5500 | time:  2.90s | valid loss  0.40 | valid ppl     1.488
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 111 at step     5550 | time:  2.80s | valid loss  0.35 | valid ppl     1.417
----------------------------------------------------------------------------------------------------
| epoch   1 step     5600 |   5600 batches | lr 0.0001 | ms/batch 57.18 | loss  0.40 | ppl     1.493
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 112 at step     5600 | time:  2.87s | valid loss  0.40 | valid ppl     1.496
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 113 at step     5650 | time:  2.86s | valid loss  0.37 | valid ppl     1.442
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 114 at step     5700 | time:  2.97s | valid loss  0.41 | valid ppl     1.502
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 115 at step     5750 | time:  2.84s | valid loss  0.43 | valid ppl     1.535
----------------------------------------------------------------------------------------------------
| epoch   1 step     5800 |   5800 batches | lr 0.0001 | ms/batch 57.90 | loss  0.40 | ppl     1.496
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 116 at step     5800 | time:  2.80s | valid loss  0.38 | valid ppl     1.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 117 at step     5850 | time:  2.96s | valid loss  0.39 | valid ppl     1.470
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 118 at step     5900 | time:  2.82s | valid loss  0.42 | valid ppl     1.523
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 119 at step     5950 | time:  2.90s | valid loss  0.37 | valid ppl     1.454
----------------------------------------------------------------------------------------------------
| epoch   1 step     6000 |   6000 batches | lr 0.0001 | ms/batch 57.85 | loss  0.41 | ppl     1.503
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 120 at step     6000 | time:  2.82s | valid loss  0.42 | valid ppl     1.522
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 121 at step     6050 | time:  2.86s | valid loss  0.38 | valid ppl     1.467
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 122 at step     6100 | time:  2.87s | valid loss  0.39 | valid ppl     1.472
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 123 at step     6150 | time:  2.88s | valid loss  0.51 | valid ppl     1.662
----------------------------------------------------------------------------------------------------
| epoch   1 step     6200 |   6200 batches | lr 0.0001 | ms/batch 57.67 | loss  0.40 | ppl     1.497
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 124 at step     6200 | time:  2.86s | valid loss  0.46 | valid ppl     1.587
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 125 at step     6250 | time:  2.95s | valid loss  0.34 | valid ppl     1.407
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 126 at step     6300 | time:  2.89s | valid loss  0.37 | valid ppl     1.442
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 127 at step     6350 | time:  2.82s | valid loss  0.40 | valid ppl     1.487
----------------------------------------------------------------------------------------------------
| epoch   1 step     6400 |   6400 batches | lr 0.0001 | ms/batch 58.23 | loss  0.41 | ppl     1.502
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 128 at step     6400 | time:  2.91s | valid loss  0.39 | valid ppl     1.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 129 at step     6450 | time:  2.81s | valid loss  0.39 | valid ppl     1.479
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 130 at step     6500 | time:  2.90s | valid loss  0.45 | valid ppl     1.568
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 131 at step     6550 | time:  2.82s | valid loss  0.32 | valid ppl     1.374
----------------------------------------------------------------------------------------------------
| epoch   1 step     6600 |   6600 batches | lr 0.0001 | ms/batch 58.33 | loss  0.39 | ppl     1.478
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 132 at step     6600 | time:  2.94s | valid loss  0.52 | valid ppl     1.690
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 133 at step     6650 | time:  2.82s | valid loss  0.39 | valid ppl     1.471
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 134 at step     6700 | time:  2.87s | valid loss  0.41 | valid ppl     1.506
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 135 at step     6750 | time:  2.96s | valid loss  0.42 | valid ppl     1.526
----------------------------------------------------------------------------------------------------
| epoch   1 step     6800 |   6800 batches | lr 0.0001 | ms/batch 58.10 | loss  0.42 | ppl     1.518
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 136 at step     6800 | time:  2.89s | valid loss  0.37 | valid ppl     1.455
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 137 at step     6850 | time:  2.85s | valid loss  0.45 | valid ppl     1.569
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 138 at step     6900 | time:  2.87s | valid loss  0.41 | valid ppl     1.513
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 139 at step     6950 | time:  2.89s | valid loss  0.45 | valid ppl     1.568
----------------------------------------------------------------------------------------------------
| epoch   1 step     7000 |   7000 batches | lr 0.0001 | ms/batch 57.71 | loss  0.40 | ppl     1.497
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 140 at step     7000 | time:  2.83s | valid loss  0.36 | valid ppl     1.430
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 141 at step     7050 | time:  2.92s | valid loss  0.48 | valid ppl     1.615
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 142 at step     7100 | time:  2.82s | valid loss  0.42 | valid ppl     1.529
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 143 at step     7150 | time:  2.96s | valid loss  0.43 | valid ppl     1.536
----------------------------------------------------------------------------------------------------
| epoch   1 step     7200 |   7200 batches | lr 0.0001 | ms/batch 57.95 | loss  0.41 | ppl     1.502
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 144 at step     7200 | time:  2.82s | valid loss  0.44 | valid ppl     1.547
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 145 at step     7250 | time:  2.90s | valid loss  0.37 | valid ppl     1.454
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 146 at step     7300 | time:  2.94s | valid loss  0.38 | valid ppl     1.464
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 147 at step     7350 | time:  2.88s | valid loss  0.39 | valid ppl     1.472
----------------------------------------------------------------------------------------------------
| epoch   1 step     7400 |   7400 batches | lr 0.0001 | ms/batch 58.27 | loss  0.41 | ppl     1.506
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 148 at step     7400 | time:  2.88s | valid loss  0.37 | valid ppl     1.450
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 149 at step     7450 | time:  2.85s | valid loss  0.41 | valid ppl     1.503
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 150 at step     7500 | time:  2.90s | valid loss  0.39 | valid ppl     1.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 151 at step     7550 | time:  2.83s | valid loss  0.40 | valid ppl     1.495
----------------------------------------------------------------------------------------------------
| epoch   1 step     7600 |   7600 batches | lr 0.0001 | ms/batch 57.89 | loss  0.40 | ppl     1.489
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 152 at step     7600 | time:  2.91s | valid loss  0.36 | valid ppl     1.435
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 153 at step     7650 | time:  2.81s | valid loss  0.36 | valid ppl     1.435
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 154 at step     7700 | time:  2.96s | valid loss  0.38 | valid ppl     1.459
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 155 at step     7750 | time:  2.80s | valid loss  0.36 | valid ppl     1.440
----------------------------------------------------------------------------------------------------
| epoch   1 step     7800 |   7800 batches | lr 0.0001 | ms/batch 57.43 | loss  0.41 | ppl     1.503
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 156 at step     7800 | time:  3.00s | valid loss  0.40 | valid ppl     1.493
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 157 at step     7850 | time:  2.82s | valid loss  0.47 | valid ppl     1.608
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 158 at step     7900 | time:  2.87s | valid loss  0.35 | valid ppl     1.419
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 159 at step     7950 | time:  2.87s | valid loss  0.41 | valid ppl     1.501
----------------------------------------------------------------------------------------------------
| epoch   1 step     8000 |   8000 batches | lr 0.0001 | ms/batch 57.93 | loss  0.40 | ppl     1.494
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 160 at step     8000 | time:  2.88s | valid loss  0.42 | valid ppl     1.521
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 161 at step     8050 | time:  2.87s | valid loss  0.37 | valid ppl     1.442
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 162 at step     8100 | time:  2.84s | valid loss  0.40 | valid ppl     1.497
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 163 at step     8150 | time:  2.92s | valid loss  0.39 | valid ppl     1.481
----------------------------------------------------------------------------------------------------
| epoch   1 step     8200 |   8200 batches | lr 0.0001 | ms/batch 57.94 | loss  0.40 | ppl     1.492
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 164 at step     8200 | time:  2.83s | valid loss  0.38 | valid ppl     1.462
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 165 at step     8250 | time:  2.93s | valid loss  0.42 | valid ppl     1.527
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 166 at step     8300 | time:  2.81s | valid loss  0.40 | valid ppl     1.493
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 167 at step     8350 | time:  3.02s | valid loss  0.38 | valid ppl     1.457
----------------------------------------------------------------------------------------------------
| epoch   1 step     8400 |   8400 batches | lr 0.0001 | ms/batch 58.39 | loss  0.40 | ppl     1.493
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 168 at step     8400 | time:  2.87s | valid loss  0.46 | valid ppl     1.584
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 169 at step     8450 | time:  2.90s | valid loss  0.41 | valid ppl     1.507
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 170 at step     8500 | time:  2.87s | valid loss  0.39 | valid ppl     1.476
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 171 at step     8550 | time:  2.86s | valid loss  0.37 | valid ppl     1.451
----------------------------------------------------------------------------------------------------
| epoch   1 step     8600 |   8600 batches | lr 0.0001 | ms/batch 58.06 | loss  0.40 | ppl     1.495
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 172 at step     8600 | time:  2.91s | valid loss  0.44 | valid ppl     1.550
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 173 at step     8650 | time:  2.81s | valid loss  0.40 | valid ppl     1.490
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 174 at step     8700 | time:  2.95s | valid loss  0.38 | valid ppl     1.458
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 175 at step     8750 | time:  2.80s | valid loss  0.39 | valid ppl     1.476
----------------------------------------------------------------------------------------------------
| epoch   1 step     8800 |   8800 batches | lr 0.0001 | ms/batch 57.79 | loss  0.41 | ppl     1.500
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 176 at step     8800 | time:  2.94s | valid loss  0.35 | valid ppl     1.424
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 177 at step     8850 | time:  2.94s | valid loss  0.39 | valid ppl     1.475
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 178 at step     8900 | time:  2.93s | valid loss  0.41 | valid ppl     1.507
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 179 at step     8950 | time:  2.82s | valid loss  0.37 | valid ppl     1.449
----------------------------------------------------------------------------------------------------
| epoch   1 step     9000 |   9000 batches | lr 0.0001 | ms/batch 58.16 | loss  0.39 | ppl     1.482
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 180 at step     9000 | time:  2.90s | valid loss  0.42 | valid ppl     1.529
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 181 at step     9050 | time:  2.88s | valid loss  0.43 | valid ppl     1.534
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 182 at step     9100 | time:  2.87s | valid loss  0.41 | valid ppl     1.510
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 183 at step     9150 | time:  2.86s | valid loss  0.45 | valid ppl     1.567
----------------------------------------------------------------------------------------------------
| epoch   1 step     9200 |   9200 batches | lr 0.0001 | ms/batch 57.68 | loss  0.40 | ppl     1.498
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 184 at step     9200 | time:  2.85s | valid loss  0.39 | valid ppl     1.478
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 185 at step     9250 | time:  2.93s | valid loss  0.34 | valid ppl     1.402
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 186 at step     9300 | time:  2.81s | valid loss  0.42 | valid ppl     1.517
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 187 at step     9350 | time:  2.93s | valid loss  0.41 | valid ppl     1.504
----------------------------------------------------------------------------------------------------
| epoch   1 step     9400 |   9400 batches | lr 0.0001 | ms/batch 58.62 | loss  0.41 | ppl     1.507
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 188 at step     9400 | time:  2.93s | valid loss  0.35 | valid ppl     1.412
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 189 at step     9450 | time:  2.89s | valid loss  0.39 | valid ppl     1.479
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 190 at step     9500 | time:  2.84s | valid loss  0.51 | valid ppl     1.660
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 191 at step     9550 | time:  2.90s | valid loss  0.39 | valid ppl     1.483
----------------------------------------------------------------------------------------------------
| epoch   1 step     9600 |   9600 batches | lr 0.0001 | ms/batch 57.80 | loss  0.40 | ppl     1.498
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 192 at step     9600 | time:  2.87s | valid loss  0.40 | valid ppl     1.485
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 193 at step     9650 | time:  2.90s | valid loss  0.38 | valid ppl     1.460
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 194 at step     9700 | time:  2.89s | valid loss  0.36 | valid ppl     1.440
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 195 at step     9750 | time:  2.97s | valid loss  0.36 | valid ppl     1.427
----------------------------------------------------------------------------------------------------
| epoch   1 step     9800 |   9800 batches | lr 0.0001 | ms/batch 58.75 | loss  0.40 | ppl     1.496
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 196 at step     9800 | time:  2.91s | valid loss  0.44 | valid ppl     1.555
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 197 at step     9850 | time:  2.81s | valid loss  0.39 | valid ppl     1.483
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 198 at step     9900 | time:  2.91s | valid loss  0.38 | valid ppl     1.456
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 199 at step     9950 | time:  2.95s | valid loss  0.37 | valid ppl     1.445
----------------------------------------------------------------------------------------------------
| epoch   1 step    10000 |  10000 batches | lr 0.0001 | ms/batch 58.45 | loss  0.41 | ppl     1.501
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 200 at step    10000 | time:  2.93s | valid loss  0.31 | valid ppl     1.358
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 201 at step    10050 | time:  2.80s | valid loss  0.40 | valid ppl     1.491
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 202 at step    10100 | time:  2.90s | valid loss  0.45 | valid ppl     1.573
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 203 at step    10150 | time:  2.84s | valid loss  0.47 | valid ppl     1.599
----------------------------------------------------------------------------------------------------
| epoch   1 step    10200 |  10200 batches | lr 0.0001 | ms/batch 58.35 | loss  0.39 | ppl     1.483
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 204 at step    10200 | time:  2.91s | valid loss  0.48 | valid ppl     1.623
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 205 at step    10250 | time:  2.84s | valid loss  0.37 | valid ppl     1.455
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 206 at step    10300 | time:  2.88s | valid loss  0.33 | valid ppl     1.388
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 207 at step    10350 | time:  2.85s | valid loss  0.36 | valid ppl     1.429
----------------------------------------------------------------------------------------------------
| epoch   1 step    10400 |  10400 batches | lr 0.0001 | ms/batch 57.68 | loss  0.38 | ppl     1.469
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 208 at step    10400 | time:  2.88s | valid loss  0.33 | valid ppl     1.386
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 209 at step    10450 | time:  3.02s | valid loss  0.37 | valid ppl     1.443
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 210 at step    10500 | time:  2.82s | valid loss  0.36 | valid ppl     1.429
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 211 at step    10550 | time:  2.91s | valid loss  0.62 | valid ppl     1.851
----------------------------------------------------------------------------------------------------
| epoch   1 step    10600 |  10600 batches | lr 0.0001 | ms/batch 58.37 | loss  0.37 | ppl     1.446
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 212 at step    10600 | time:  2.85s | valid loss  0.43 | valid ppl     1.533
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 213 at step    10650 | time:  2.92s | valid loss  0.37 | valid ppl     1.446
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 214 at step    10700 | time:  2.81s | valid loss  0.34 | valid ppl     1.409
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 215 at step    10750 | time:  2.89s | valid loss  0.34 | valid ppl     1.409
----------------------------------------------------------------------------------------------------
| epoch   1 step    10800 |  10800 batches | lr 0.0001 | ms/batch 57.76 | loss  0.38 | ppl     1.464
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 216 at step    10800 | time:  2.85s | valid loss  0.29 | valid ppl     1.339
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 217 at step    10850 | time:  2.88s | valid loss  0.35 | valid ppl     1.422
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 218 at step    10900 | time:  2.86s | valid loss  0.30 | valid ppl     1.356
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 219 at step    10950 | time:  2.86s | valid loss  0.36 | valid ppl     1.429
----------------------------------------------------------------------------------------------------
| epoch   1 step    11000 |  11000 batches | lr 0.0001 | ms/batch 59.18 | loss  0.34 | ppl     1.400
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 220 at step    11000 | time:  2.95s | valid loss  0.34 | valid ppl     1.409
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 221 at step    11050 | time:  2.87s | valid loss  0.28 | valid ppl     1.319
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 222 at step    11100 | time:  2.89s | valid loss  0.31 | valid ppl     1.368
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 223 at step    11150 | time:  2.84s | valid loss  0.34 | valid ppl     1.406
----------------------------------------------------------------------------------------------------
| epoch   1 step    11200 |  11200 batches | lr 0.0001 | ms/batch 59.16 | loss  0.33 | ppl     1.385
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 224 at step    11200 | time:  2.97s | valid loss  0.29 | valid ppl     1.331
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 225 at step    11250 | time:  2.80s | valid loss  0.36 | valid ppl     1.429
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 226 at step    11300 | time:  2.94s | valid loss  0.30 | valid ppl     1.353
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 227 at step    11350 | time:  2.83s | valid loss  0.33 | valid ppl     1.390
----------------------------------------------------------------------------------------------------
| epoch   1 step    11400 |  11400 batches | lr 0.0001 | ms/batch 57.62 | loss  0.34 | ppl     1.403
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 228 at step    11400 | time:  2.92s | valid loss  0.33 | valid ppl     1.391
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 229 at step    11450 | time:  2.81s | valid loss  0.30 | valid ppl     1.355
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 230 at step    11500 | time:  3.01s | valid loss  0.34 | valid ppl     1.407
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 231 at step    11550 | time:  2.89s | valid loss  0.30 | valid ppl     1.352
----------------------------------------------------------------------------------------------------
| epoch   1 step    11600 |  11600 batches | lr 0.0001 | ms/batch 58.29 | loss  0.33 | ppl     1.388
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 232 at step    11600 | time:  2.83s | valid loss  0.37 | valid ppl     1.451
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 233 at step    11650 | time:  2.91s | valid loss  0.37 | valid ppl     1.447
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 234 at step    11700 | time:  2.80s | valid loss  0.36 | valid ppl     1.432
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 235 at step    11750 | time:  2.92s | valid loss  0.30 | valid ppl     1.346
----------------------------------------------------------------------------------------------------
| epoch   1 step    11800 |  11800 batches | lr 0.0001 | ms/batch 57.84 | loss  0.32 | ppl     1.375
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 236 at step    11800 | time:  2.85s | valid loss  0.35 | valid ppl     1.424
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 237 at step    11850 | time:  2.91s | valid loss  0.31 | valid ppl     1.361
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 238 at step    11900 | time:  2.81s | valid loss  0.32 | valid ppl     1.374
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 239 at step    11950 | time:  2.89s | valid loss  0.37 | valid ppl     1.447
----------------------------------------------------------------------------------------------------
| epoch   1 step    12000 |  12000 batches | lr 0.0001 | ms/batch 57.64 | loss  0.32 | ppl     1.383
Before eval loop
After eval loop
----------------------------------------------------------------------------------------------------
| Eval 240 at step    12000 | time:  2.87s | valid loss  0.31 | valid ppl     1.363
----------------------------------------------------------------------------------------------------
Before eval loop
After eval loop
